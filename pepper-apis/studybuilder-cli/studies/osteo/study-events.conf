{
  "events": [
    # populate profile events
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "COPY_ANSWER",
        "copyConfigPairs": [
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_FIRSTNAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_FIRST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_LASTNAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_LAST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_DOB"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_BIRTH_DATE"
            }
          }
        ]
      },
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "UPDATE_CUSTOM_WORKFLOW",
        "workflow": "OSTEO_RECONSENTED",
        "status": "Complete"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].instances[latest].hasPreviousInstance()"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 3
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "UPDATE_CUSTOM_WORKFLOW",
        "workflow": "OSTEO_RECONSENTED",
        "status": "Complete"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].instances[latest].hasPreviousInstance()"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 3
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "UPDATE_CUSTOM_WORKFLOW",
        "workflow": "OSTEO_RECONSENTED",
        "status": "Complete"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].instances[latest].hasPreviousInstance()"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 3
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "CONSENT_ADDENDUM"
      },
      "preconditionExpr": """
        (
          ( !user.studies["CMI-OSTEO"].isGovernedParticipant() &&
            !user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() &&
            !(user.studies["CMI-OSTEO"].forms["ADD_PARTICIPANT"].questions["CHILD_COUNTRY_COPY"].answers.hasOption("CA")
              || user.studies["CMI-OSTEO"].forms["ADD_PARTICIPANT"].questions["CHILD_STATE_COPY"].answers.hasOption("NY"))
          )
          ||
          (!user.studies["CMI-OSTEO"].isGovernedParticipant() &&
              user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() &&
              !( user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("CA")
              || user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_STATE"].answers.hasOption("NY"))
          )
        )
        && user.studies["CMI-OSTEO"].forms["CONSENT"].questions["CONSENT_TISSUE"].answers.hasTrue()
      """
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 4
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC"
      },
      "preconditionExpr": """
        ((
          operator.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()
          && !(
            operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("CA")
            || operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_STATE"].answers.hasOption("NY")
          )
        ) || (
          user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()
          && !(
            user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("CA")
            || user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_STATE"].answers.hasOption("NY")
          )
        ))
        && user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].questions["CONSENT_ASSENT_TISSUE"].answers.hasTrue()"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 4
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC"
      },
      "preconditionExpr": """
        ((
          operator.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()
          && !(
            operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("CA")
            || operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_STATE"].answers.hasOption("NY")
          )
        ) || (
          user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()
          && !(
            user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("CA")
            || user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_STATE"].answers.hasOption("NY")
          )
        ))
        && user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].questions["PARENTAL_CONSENT_TISSUE"].answers.hasTrue()"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 4
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "COPY_ANSWER",
        "copyConfigPairs": [
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "PARENTAL_CONSENT_CHILD_FIRSTNAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_FIRST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "PARENTAL_CONSENT_CHILD_LASTNAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_LAST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "PARENTAL_CONSENT_CHILD_DOB"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_BIRTH_DATE"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "PARENTAL_CONSENT_FIRSTNAME"
            },
            "target": {
              "type": "OPERATOR_PROFILE_FIRST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "PARENTAL_CONSENT_LASTNAME"
            },
            "target": {
              "type": "OPERATOR_PROFILE_LAST_NAME"
            }
          }
        ]
      },
      "dispatchToHousekeeping": false,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "COPY_ANSWER",
        "copyConfigPairs": [
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_ASSENT_CHILD_FIRSTNAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_FIRST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_ASSENT_CHILD_LASTNAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_LAST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_ASSENT_CHILD_DOB"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_BIRTH_DATE"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_ASSENT_FIRSTNAME"
            },
            "target": {
              "type": "OPERATOR_PROFILE_FIRST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CONSENT_ASSENT_LASTNAME"
            },
            "target": {
              "type": "OPERATOR_PROFILE_LAST_NAME"
            }
          }
        ]
      },
      "dispatchToHousekeeping": false,
      "order": 2
    },

    # activity instance creation events

    ## PREQUAL TO CONSENT
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PREQUAL",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "LOVEDONE"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DECEASED")""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PREQUAL",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "CONSENT"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")
        && (
          ( user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("US")
            && (
              ( user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_STATE"].answers.hasOption("AL")
                && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_CURRENT_AGE"].answers.value() >= 19
              ) || (
                !user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_STATE"].answers.hasOption("AL")
                && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_CURRENT_AGE"].answers.value() >= 18
              )
            )
          ) || (
            user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("CA")
            && (
              ( user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_PROVINCE"].answers.hasAnyOption("BC", "NB", "NL", "NT", "NS", "NU", "YT")
                && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_CURRENT_AGE"].answers.value() >= 19
              ) || (
                user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_PROVINCE"].answers.hasAnyOption("AB", "MB", "ON", "PE", "QC", "SK")
                && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_CURRENT_AGE"].answers.value() >= 18
              )
            )
          ) || (
            user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("PR")
            && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_CURRENT_AGE"].answers.value() >= 21
          ) || (
            user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasAnyOption("GU", "VI", "MP", "AS")
            && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_CURRENT_AGE"].answers.value() >= 18
          )
        )
      """,
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUT_YOU_ACTIVITY",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "FAMILY_HISTORY_SELF"
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 4
    },

    ## CONSENT TO RELEASE
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "RELEASE_SELF"
      },
      "maxOccurrencesPerUser": 1,
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["CONSENT"].questions["CONSENT_TISSUE"].answers.hasFalse()
        || (!user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()
          && !user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].hasInstance())
        || (user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()
          && (
            user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("CA")
            || user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_STATE"].answers.hasOption("NY")
          )
        )
      """
      "dispatchToHousekeeping": false,
      "order": 5
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "RELEASE_MINOR"
      },
      "maxOccurrencesPerUser": 1,
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].hasInstance()""",
      "dispatchToHousekeeping": false,
      "order": 5
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ADD_PARTICIPANT"
      },
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "RELEASE_MINOR"
      },
      "maxOccurrencesPerUser": 1,
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].hasInstance()""",
      "dispatchToHousekeeping": false,
      "order": 5
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "RELEASE_MINOR"
      },
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].isGovernedParticipant() &&
        ((operator.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() && operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("CA")) ||
        (operator.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() && operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_STATE"].answers.hasOption("NY")) ||
        (user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("CA")) ||
        (user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_STATE"].answers.hasOption("NY")) ||
        user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].questions["CONSENT_ASSENT_TISSUE"].answers.hasFalse()) &&
        !user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance()
      """
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 5
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ADD_PARTICIPANT"
      },
      "dispatchToHousekeeping": false,
      "order": 1
    },
    ##CONSENT to ABOUTYOU if RELEASE is submitted.. handle osteo2 edge case
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUTYOU"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].hasInstance() ||
       (user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].hasInstance() && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].isStatus("CREATED", "IN_PROGRESS")) ||
       (user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].hasInstance() && user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("CREATED", "IN_PROGRESS"))""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 6
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUT_YOU_ACTIVITY"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].hasInstance() && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].isStatus("CREATED", "IN_PROGRESS")""",
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].hasInstance() && user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE"))"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 7
    },

    ##PARENTAL_CONSENT to ABOUTYOU if RELEASE_MINOR is submitted.. handle osteo2 edge case
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUTYOU"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].hasInstance() ||
       (user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].hasInstance() && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("CREATED", "IN_PROGRESS")) ||
       (user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance() && user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("CREATED", "IN_PROGRESS"))""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 7
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUT_YOU_ACTIVITY"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].hasInstance() && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("CREATED", "IN_PROGRESS")""",
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].hasInstance() && user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].isStatus("COMPLETE"))"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 8
    },

    ##CONSENT_ASSENT to ABOUTYOU if RELEASE_MINOR is submitted.. handle osteo2 edge case
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUTYOU"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].hasInstance() ||
       (user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].hasInstance() && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("CREATED", "IN_PROGRESS")) ||
       (user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance() && user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("CREATED", "IN_PROGRESS"))""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 6
    },

    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUT_YOU_ACTIVITY"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].hasInstance() && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("CREATED", "IN_PROGRESS")""",
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].hasInstance() && user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].isStatus("COMPLETE"))"""
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 7
    },

    ##PEDIATRIC ADDENDUM to ABOUTYOU V1->V2
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUTYOU"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].hasInstance() ||
       (user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance() && user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("CREATED", "IN_PROGRESS"))""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 5
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUT_YOU_ACTIVITY"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].hasInstance() && user.studies["CMI-OSTEO"].forms["ABOUTCHILD"].isStatus("COMPLETE"))""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 6
    },

    ##ADDENDUM to ABOUTYOU V1->V2
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUTYOU"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].hasInstance() ||
       (user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].hasInstance() && user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("CREATED", "IN_PROGRESS"))""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 6
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUT_YOU_ACTIVITY"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].hasInstance() && user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE"))""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 7
    },

    ## RELEASE TO ABOUT YOU
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUTYOU"
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].hasInstance()""",
      "preconditionExpr":"""!user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTYOU",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUT_YOU_ACTIVITY"
      },
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["ABOUT_YOU_ACTIVITY"].hasInstance()""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 3
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUTYOU"
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    # email events

    ## join mailing list email
    {
      "trigger": {
        "type": "JOIN_MAILING_LIST"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.joinMailingList},
        "language": "en",
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## welcome email
    {
      "trigger": {
        "type": "USER_REGISTERED",
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfWelcome},
        "linkedActivityCode": "CONSENT",
        "language": "en",
        "pdfAttachments": []
      },
      #"cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "USER_REGISTERED",
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalWelcome},
        "linkedActivityCode": "PARENTAL_CONSENT",
        "language": "en",
        "pdfAttachments": []
      },
      #"cancelExpr": """!user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].hasInstance()""",
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
        && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_CURRENT_AGE"].answers.value() < 7
      """,
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "USER_REGISTERED",
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalWelcome},
        "linkedActivityCode": "CONSENT_ASSENT",
        "language": "en",
        "pdfAttachments": []
      },
      #"cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].hasInstance()""",
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
        && user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_CURRENT_AGE"].answers.value() >= 7
      """,
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## consent email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfConsentCompleted},
        "linkedActivityCode": "RELEASE_SELF",
        "language": "en",
        "pdfAttachments": [
          { "pdfName": "osproject-consent", "generateIfMissing": true }
        ]
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].hasAgedUp()""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalConsentCompleted},
        "linkedActivityCode": "RELEASE_MINOR",
        "language": "en",
        "pdfAttachments": [
          { "pdfName": "osproject-consent-parental", "generateIfMissing": true }
        ]
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalConsentCompleted},
        "linkedActivityCode": "RELEASE_MINOR",
        "language": "en",
        "pdfAttachments": [
          { "pdfName": "osproject-consent-assent", "generateIfMissing": true }
        ]
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## medical release email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfReleaseCompleted},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].hasAgedUp()""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalReleaseCompleted},
        "language": "en",
        "pdfAttachments": []
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## consent reminder email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfConsent1wkReminder},
        "linkedActivityCode": "CONSENT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE")
        || user.studies["CMI-OSTEO"].hasAgedUp()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalConsent1wkReminder},
        "linkedActivityCode": "PARENTAL_CONSENT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalConsent1wkReminder},
        "linkedActivityCode": "CONSENT_ASSENT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ADD_PARTICIPANT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "COPY_ANSWER",
        "copyConfigPairs": [
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CHILD_COUNTRY",
              "user": "OPERATOR",
            },
            "target": {
              "type": "ANSWER",
              "questionStableId": "CHILD_COUNTRY_COPY",
              "user": "USER",
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CHILD_STATE",
              "user": "OPERATOR",
            },
            "target": {
              "type": "ANSWER",
              "questionStableId": "CHILD_STATE_COPY",
              "user": "USER",
            }
          }
        ]
      },
      "preconditionExpr": """operator.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()""",
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ADD_PARTICIPANT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "COPY_ANSWER",
        "copyConfigPairs": [
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CHILD_COUNTRY",
            },
            "target": {
              "type": "ANSWER",
              "questionStableId": "CHILD_COUNTRY_COPY",
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "CHILD_STATE",
            },
            "target": {
              "type": "ANSWER",
              "questionStableId": "CHILD_STATE_COPY",
              "user": "USER",
            }
          }
        ]
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance()""",
      "dispatchToHousekeeping": false,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfConsent2wkReminder},
        "linkedActivityCode": "CONSENT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE")
        || user.studies["CMI-OSTEO"].hasAgedUp()""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalConsent2wkReminder},
        "linkedActivityCode": "PARENTAL_CONSENT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalConsent2wkReminder},
        "linkedActivityCode": "CONSENT_ASSENT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.enConsentAddendum},
        "language": "en",
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].questions["SOMATIC_CONSENT_TUMOR"].answers.hasTrue()
      """,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.enConsentAddendum},
        "language": "en",
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum-disagree", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].questions["SOMATIC_CONSENT_TUMOR"].answers.hasFalse()
      """,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.enParentalConsentAddendum},
        "language": "en",
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum-pediatric", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].questions["SOMATIC_CONSENT_TUMOR_PEDIATRIC"].answers.hasTrue()
      """,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.enParentalConsentAddendum},
        "language": "en",
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum-pediatric-disagree", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].questions["SOMATIC_CONSENT_TUMOR_PEDIATRIC"].answers.hasFalse()
      """,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.ParentalConsentAddendumReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.ConsentAddendumReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.GermlineAddendumReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.GermlineAddendumComplete},
        "language": "en",
        "pdfAttachments": []
      },
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.ParentalGermlineAddendumReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.ParentalGermlineAddendumComplete},
        "language": "en",
        "pdfAttachments": []
      },
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## release reminder email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfReleaseReminder},
        "linkedActivityCode": "RELEASE_SELF",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("COMPLETE")
        || user.studies["CMI-OSTEO"].hasAgedUp()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalReleaseReminder},
        "linkedActivityCode": "RELEASE_MINOR",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfReleaseReminder},
        "linkedActivityCode": "RELEASE_SELF",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("COMPLETE")
        || user.studies["CMI-OSTEO"].hasAgedUp()""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalReleaseReminder},
        "linkedActivityCode": "RELEASE_MINOR",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## about-you reminder email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTYOU",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.aboutYouReminder},
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE")""",
      "preconditionExpr":"""!user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTYOU",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.aboutChildReminder},
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE")""",
      "preconditionExpr":"""user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## dsm notification emails
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "SALIVA_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfSalivaReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "SALIVA_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalSalivaReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfBloodReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalBloodReceived},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfBloodSent},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalBloodSent},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT_4WK"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.selfBloodSentReminder},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT_4WK"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.parentalBloodSentReminder},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "SALIVA_RECEIVED"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC"
      },
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].isGovernedParticipant() &&
        user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("COMPLETE") &&
        (
          (
           user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() &&
           user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("US")
          )
           ||
          (
            user.studies["CMI-OSTEO"].forms["ADD_PARTICIPANT"].hasInstance() &&
            user.studies["CMI-OSTEO"].forms["ADD_PARTICIPANT"].questions["CHILD_COUNTRY_COPY"].answers.hasOption("US")
          )
        )""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 2
    }

    # enrollment events
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "USER_ENROLLED"
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "USER_ENROLLED"
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },

    # announcement events
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ANNOUNCEMENT",
        "msgTemplate": { include required("snippets/thank-you-announcement-msg.conf") }
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ANNOUNCEMENT",
        "msgTemplate": { include required("snippets/thank-you-announcement-msg-child.conf") }
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 2
    },

    # medical update events for release pdfs
    {
      "trigger": {
        "type": "MEDICAL_UPDATE"
      },
      "action": {
        "type": "PDF_GENERATION",
        "pdfName": "osproject-release"
      },
      "cancelExpr": """
        ! (user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE")
        && user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("COMPLETE"))
      """,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "MEDICAL_UPDATE"
      },
      "action": {
        "type": "PDF_GENERATION",
        "pdfName": "osproject-release-parental"
      },
      "cancelExpr": """
        ! (user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].isStatus("COMPLETE")
        && user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("COMPLETE"))
        || user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].hasInstance()
      """,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "MEDICAL_UPDATE"
      },
      "action": {
        "type": "PDF_GENERATION",
        "pdfName": "osproject-release-consent-assent"
      },
      "cancelExpr": """
        ! (user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].isStatus("COMPLETE")
        && user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("COMPLETE"))
        || user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].hasInstance()
      """,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    # reconsent events

    ## collecting child's contact email
    {
      "trigger": {
        "type": "REACHED_AOM_PREP",
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "CHILD_CONTACT"
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      }
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.reconsentChildContact},
        "linkedActivityCode": "CHILD_CONTACT",
        "language": "en",
        "pdfAttachments": []
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## child-contact reminder emails
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.reconsentChildContact1wkReminder},
        "linkedActivityCode": "CHILD_CONTACT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CHILD_CONTACT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.reconsentChildContact2wkReminder},
        "linkedActivityCode": "CHILD_CONTACT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CHILD_CONTACT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.reconsentChildContact4wkReminder},
        "linkedActivityCode": "CHILD_CONTACT",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CHILD_CONTACT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.four},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## verifying child's contact email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "CREATE_INVITATION",
        "markExistingAsVoided": true,
        "contactEmailQuestionStableId": "CHILD_CONTACT_EMAIL"
      },
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "INVITATION_CREATED"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "emailTemplate": ${emails.reconsentEmailVerification},
        "language": "en",
        "pdfAttachments": []
      },
      # Invitation is created after participant reached age-of-majority,
      # so skip verify email since we'll send out the next-steps emails.
      "cancelExpr": """user.studies["CMI-OSTEO"].hasAgedUp()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## events at age-up
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "emailTemplate": ${emails.reconsentNextSteps},
        "language": "en",
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## reconsent/next steps reminder emails
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "emailTemplate": ${emails.reconsentNextSteps1wkReminder},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """(user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE"))""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "emailTemplate": ${emails.reconsentNextSteps2wkReminder},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """(user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE"))""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "emailTemplate": ${emails.reconsentNextSteps4wkReminder},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """(user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE"))""",
      "delaySeconds": ${delay.weeks.four},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## after child registration
    {
      "trigger": {
        "type": "GOVERNED_USER_REGISTERED"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "CONSENT"
      },
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "GOVERNED_USER_REGISTERED"
      },
      "action": {
        "type": "HIDE_ACTIVITIES",
        "activityCodes": ["CHILD_CONTACT"]
      },
      "dispatchToHousekeeping": false,
      "order": 2
    },
    {
      "trigger": {
        "type": "GOVERNED_USER_REGISTERED",
      },
      "action": {
        "type": "ANNOUNCEMENT",
        "permanent": true,
        "createForProxies": true,
        "msgTemplate": { include required("snippets/former-proxy-announcement-msg.conf") }
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 3
    },
    {
      "trigger": {
        "type": "GOVERNED_USER_REGISTERED"
      },
      "action": {
        "type": "REVOKE_PROXIES"
      },
      "dispatchToHousekeeping": false,
      # Order here is important. Since announcement `createForProxies` only create for active proxies,
      # we should queue up announcement before inactivating proxy.
      "order": 4
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "HIDE_ACTIVITIES",
        "activityCodes": ["RELEASE_MINOR"],
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance()""",
      "dispatchToHousekeeping": false,
      "order": 1
    },
    ## after submitting new consent
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.reconsentThankYou},
        "language": "en",
        "pdfAttachments": [
          { "pdfName": "osproject-consent", "generateIfMissing": true }
        ]
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].hasAgedUp()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## after submitting new release
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "emailTemplate": ${emails.reconsentReleaseCompleted},
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].hasAgedUp()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },

    # exit request event
    {
      "trigger": {
        "type": "EXIT_REQUEST"
      },
      "action": {
        "type": "STUDY_EMAIL",
        "emailTemplate": ${emails.exitRequest},
        "language": "en",
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "SALIVA_RECEIVED"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM"
      },
      "preconditionExpr": """
          !user.studies["CMI-OSTEO"].isGovernedParticipant() &&
           user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("COMPLETE") &&
          ((
            !user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() &&
            user.studies["CMI-OSTEO"].forms["ADD_PARTICIPANT"].questions["CHILD_COUNTRY_COPY"].answers.hasOption("US")
          )
          ||
          (
              user.studies["CMI-OSTEO"].forms["PREQUAL"].hasInstance() &&
              user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("US")
          ))
          """,
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTCHILD",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "ABOUT_YOU_ACTIVITY"
      },
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["ABOUT_YOU_ACTIVITY"].hasInstance() &&
       user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 3
    },
    ## CONSENT TO RELEASE
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "RELEASE_SELF"
      },
      "maxOccurrencesPerUser": 1,
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].hasInstance() && !user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ACTIVITY_INSTANCE_CREATION",
        "activityCode": "RELEASE_MINOR"
      },
      "maxOccurrencesPerUser": 1,
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].hasInstance()""",
      "dispatchToHousekeeping": false,
      "order": 1
    },
    # announcement events
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "LOVEDONE",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "ANNOUNCEMENT",
        "msgTemplate": { include required("snippets/loved-one-announcement-msg.conf") }
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "LOVEDONE",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "COPY_ANSWER",
        "copyConfigPairs": [
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "LOVEDONE_SELF_FIRST_NAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_FIRST_NAME"
            }
          },
          {
            "source": {
              "type": "ANSWER",
              "questionStableId": "LOVEDONE_SELF_LAST_NAME"
            },
            "target": {
              "type": "PARTICIPANT_PROFILE_LAST_NAME"
            }
          }
        ]
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "USER_ENROLLED"
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].hasInstance() || user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].hasInstance()""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": false,
      "order": 1
    },
    {
      "trigger": {
        "type": "GOVERNED_USER_REGISTERED"
      },
      "action": {
        "type": "HIDE_ACTIVITIES",
        "activityCodes": ["CONSENT_ASSENT"]
      },
      "dispatchToHousekeeping": false,
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].isStatus("COMPLETE")""",
      "order": 3
    },
    {
      "trigger": {
        "type": "GOVERNED_USER_REGISTERED"
      },
      "action": {
        "type": "HIDE_ACTIVITIES",
        "activityCodes": ["PARENTAL_CONSENT"]
      },
      "dispatchToHousekeeping": false,
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].isStatus("COMPLETE")""",
      "order": 4
    },
    {
      "trigger": {
        "type": "GOVERNED_USER_REGISTERED"
      },
      "action": {
        "type": "HIDE_ACTIVITIES",
        "activityCodes": ["CONSENT_ADDENDUM_PEDIATRIC"]
      },
      "dispatchToHousekeeping": false,
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("COMPLETE")""",
      "order": 5
    },
    {
      "trigger": {
        "type": "CONSENT_SUSPENDED"
      },
      "action": {
        "type": "MARK_ACTIVITIES_READ_ONLY",
        "activityCodes": ["PARENTAL_CONSENT", "CONSENT_ASSENT", "RELEASE_MINOR", "CONSENT_ADDENDUM_PEDIATRIC"]
      },
      "dispatchToHousekeeping": false,
      "order": 1
    }
  ]
}
