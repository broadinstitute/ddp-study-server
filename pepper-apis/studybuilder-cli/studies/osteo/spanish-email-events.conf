{
  "email-events": [
    # email events

    ## join mailing list email
    {
      "trigger": {
        "type": "JOIN_MAILING_LIST"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.joinMailingList}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.joinMailingList_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## welcome email
    {
      "trigger": {
        "type": "USER_REGISTERED",
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfWelcome}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfWelcome_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CONSENT",
        "pdfAttachments": []
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "USER_REGISTERED",
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          {"emailTemplate": ${emails.parentalWelcome}, "language": "en", "isDynamic": false},
          {"emailTemplate": ${emails.parentalWelcome_es}, "language": "es", "isDynamic": true}
        ],
        "linkedActivityCode": "PARENTAL_CONSENT",
        "pdfAttachments": []
      },
      "preconditionExpr": """operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
    && operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_CURRENT_AGE"].answers.value() < 7""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "USER_REGISTERED",
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalWelcome}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalWelcome_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CONSENT_ASSENT",
        "pdfAttachments": []
      },
      "preconditionExpr": """operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
    && operator.studies["CMI-OSTEO"].forms["PREQUAL"].questions["CHILD_CURRENT_AGE"].answers.value() >= 7""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## consent email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfConsentCompleted}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfConsentCompleted_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "RELEASE_SELF",
        "pdfAttachments": [
          { "pdfName": "osproject-consent-v2", "generateIfMissing": true }
        ]
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalConsentCompleted}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalConsentCompleted_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "RELEASE_MINOR",
        "pdfAttachments": [
          { "pdfName": "osproject-consent-parental-v2", "generateIfMissing": true }
        ]
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalConsentCompleted}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalConsentCompleted_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "RELEASE_MINOR",
        "pdfAttachments": [
          { "pdfName": "osproject-consent-assent-v2", "generateIfMissing": true }
        ]
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## medical release email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfReleaseCompleted}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfReleaseCompleted_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].hasInstance()
                          && !user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].hasInstance()""",
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalReleaseCompleted}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalReleaseCompleted_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## consent reminder email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfConsent1wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfConsent1wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CONSENT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE")
        || user.studies["CMI-OSTEO"].hasAgedUp()""",
      "delaySeconds": ${delay.weeks.one}, # one week in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalConsent1wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalConsent1wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "PARENTAL_CONSENT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one}, # one week in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalConsent1wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalConsent1wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CONSENT_ASSENT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one}, # one week in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfConsent2wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfConsent2wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CONSENT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE")
        || user.studies["CMI-OSTEO"].hasAgedUp()""",
      "delaySeconds": ${delay.weeks.two}, # two weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "PARENTAL_CONSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalConsent2wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalConsent2wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "PARENTAL_CONSENT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two}, # two weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ASSENT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalConsent2wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalConsent2wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CONSENT_ASSENT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two}, # two weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## release reminder email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfReleaseReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfReleaseReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "RELEASE_SELF",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one}, # one week in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalReleaseReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalReleaseReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "RELEASE_MINOR",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one}, # one week in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfReleaseReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfReleaseReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "RELEASE_SELF",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_SELF"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two}, # two weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_MINOR",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalReleaseReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalReleaseReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "RELEASE_MINOR",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["RELEASE_MINOR"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two}, # two weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## about-you reminder email

    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTYOU",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutYouReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutYouReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE")""",
      "preconditionExpr":"""user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTYOU",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutChildReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutChildReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE")""",
      "preconditionExpr":"""user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTYOU",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutYouReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutYouReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE")""",
      "preconditionExpr":"""!user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUTYOU",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutYouReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutYouReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUTYOU"].isStatus("COMPLETE")""",
      "preconditionExpr":"""!user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## about-you-activity reminder email
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUT_YOU_ACTIVITY",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutChildReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutChildReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUT_YOU_ACTIVITY"].isStatus("COMPLETE")""",
      "preconditionExpr":"""user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUT_YOU_ACTIVITY",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutChildReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutChildReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUT_YOU_ACTIVITY"].isStatus("COMPLETE")""",
      "preconditionExpr":"""user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUT_YOU_ACTIVITY",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutYouReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutYouReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "language": "en",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUT_YOU_ACTIVITY"].isStatus("COMPLETE")""",
      "preconditionExpr":"""!user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "ABOUT_YOU_ACTIVITY",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.aboutYouReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.aboutYouReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "ABOUTYOU",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["ABOUT_YOU_ACTIVITY"].isStatus("COMPLETE")""",
      "preconditionExpr":"""!user.studies["CMI-OSTEO"].isGovernedParticipant()""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## dsm notification emails
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "SALIVA_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfSalivaReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfSalivaReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "SALIVA_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalSalivaReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalSalivaReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfBloodReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfBloodReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_RECEIVED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalBloodReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalBloodReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfBloodSent}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfBloodSent_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalBloodSent}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalBloodSent_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT_4WK"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.selfBloodSentReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.selfBloodSentReminder_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "DSM_NOTIFICATION",
        "dsmEvent": "BLOOD_SENT_4WK"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.parentalBloodSentReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.parentalBloodSentReminder_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },


    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      }
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentChildContact}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentChildContact_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CHILD_CONTACT",
        "pdfAttachments": []
      },
      "maxOccurrencesPerUser": 1,
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## child-contact reminder emails
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentChildContact1wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentChildContact1wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CHILD_CONTACT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CHILD_CONTACT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one}, # one week in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentChildContact2wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentChildContact2wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CHILD_CONTACT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CHILD_CONTACT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two}, # two weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CHILD_CONTACT",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentChildContact4wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentChildContact4wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "linkedActivityCode": "CHILD_CONTACT",
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CHILD_CONTACT"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.four}, # four weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },

    {
      "trigger": {
        "type": "INVITATION_CREATED"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentEmailVerification}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentEmailVerification_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      # Invitation is created after participant reached age-of-majority,
      # so skip verify email since we'll send out the next-steps emails.
      "cancelExpr": """user.studies["CMI-OSTEO"].hasAgedUp()""",
      "dispatchToHousekeeping": true,
      "order": 2
    },

    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentNextSteps}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentNextSteps_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## reconsent/next steps reminder emails
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentNextSteps1wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentNextSteps1wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """(user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE"))""",
      "delaySeconds": ${delay.weeks.one}, # one week in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentNextSteps2wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentNextSteps2wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """(user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE"))""",
      "delaySeconds": ${delay.weeks.two}, # two weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentNextSteps4wkReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentNextSteps4wkReminder_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """(user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()
        && user.studies["CMI-OSTEO"].forms["CONSENT"].isStatus("COMPLETE"))""",
      "delaySeconds": ${delay.weeks.four}, # four weeks in seconds
      "dispatchToHousekeeping": true,
      "order": 1
    },


    ## after submitting new consent
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentThankYou}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentThankYou_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": [
          { "pdfName": "osproject-consent-v2", "generateIfMissing": true }
        ]
      },
      "cancelExpr": """!user.studies["CMI-OSTEO"].hasAgedUp()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },

    ## after submitting new release
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "RELEASE_SELF",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentReleaseCompleted}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentReleaseCompleted_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ASSENT"].hasInstance()
                          || user.studies["CMI-OSTEO"].forms["PARENTAL_CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },

    # exit request event
    {
      "trigger": {
        "type": "EXIT_REQUEST"
      },
      "action": {
        "type": "STUDY_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.exitRequest}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.exitRequest_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },
    //new events
    //consent-addendum
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.enConsentAddendum}, "language": "en", "isDynamic": false },
          {"emailTemplate": ${emails.ConsentAddendum_es}, "language": "es", "isDynamic": true}
        ],
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].questions["SOMATIC_CONSENT_TUMOR"].answers.hasTrue()
      """,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.enConsentAddendum}, "language": "en", "isDynamic": false },
          {"emailTemplate": ${emails.ConsentAddendum_es}, "language": "es", "isDynamic": true}
        ],
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum-disagree", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].questions["SOMATIC_CONSENT_TUMOR"].answers.hasFalse()
      """,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.enParentalConsentAddendum}, "language": "en", "isDynamic": false },
          {"emailTemplate": ${emails.ParentalConsentAddendum_es}, "language": "es", "isDynamic": true}
        ],
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum-pediatric", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.profile.age() < 7
        && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].questions["SOMATIC_CONSENT_TUMOR_PEDIATRIC"].answers.hasTrue()
      """,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.enParentalConsentAddendum}, "language": "en", "isDynamic": false },
          {"emailTemplate": ${emails.ParentalConsentAddendum_es}, "language": "es", "isDynamic": true}
        ],
        "pdfAttachments": [{ "pdfName": "osproject-consent-addendum-pediatric-disagree", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.profile.age() < 7
        && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].questions["SOMATIC_CONSENT_TUMOR_PEDIATRIC"].answers.hasFalse()
      """,
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.enParentalConsentAddendum}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.ParentalConsentAddendum_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": [{ "pdfName": "osproject-consent-assent-addendum-pediatric", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.profile.age() >= 7
        && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].questions["SOMATIC_CONSENT_TUMOR_PEDIATRIC"].answers.hasTrue()
      """,
      "order": 3
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.enParentalConsentAddendum}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.ParentalConsentAddendum_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": [{ "pdfName": "osproject-consent-assent-addendum-pediatric-disagree", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """
        user.profile.age() >= 7
        && user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].questions["SOMATIC_CONSENT_TUMOR_PEDIATRIC"].answers.hasFalse()
      """,
      "order": 4
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.ParentalConsentAddendumReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.ParentalConsentAddendumReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.ParentalConsentAddendumReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.ParentalConsentAddendumReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM_PEDIATRIC"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.ConsentAddendumReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.ConsentAddendumReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "CONSENT_ADDENDUM",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.ConsentAddendumReceived}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.ConsentAddendumReceived_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["CONSENT_ADDENDUM"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "REACHED_AOM"
      },
      "action": {
        "type": "INVITATION_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.reconsentEmailVerification}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.reconsentEmailVerification_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },
    # family-history reminders
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "FAMILY_HISTORY_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.familyHistoryReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.familyHistoryReminder_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr":"!user.studies[\"CMI-OSTEO\"].isGovernedParticipant()",
      "cancelExpr":"user.studies[\"CMI-OSTEO\"].forms[\"FAMILY_HISTORY_SELF\"].isStatus(\"COMPLETE\")",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "FAMILY_HISTORY_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.familyHistoryReminder}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.familyHistoryReminder_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr":"!user.studies[\"CMI-OSTEO\"].isGovernedParticipant()",
      "cancelExpr":"user.studies[\"CMI-OSTEO\"].forms[\"FAMILY_HISTORY_SELF\"].isStatus(\"COMPLETE\")",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "FAMILY_HISTORY_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.familyHistoryReminderParental}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.familyHistoryReminderParental_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr":"user.studies[\"CMI-OSTEO\"].isGovernedParticipant()",
      "cancelExpr":"user.studies[\"CMI-OSTEO\"].forms[\"FAMILY_HISTORY_SELF\"].isStatus(\"COMPLETE\")",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "FAMILY_HISTORY_SELF",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.familyHistoryReminderParental}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.familyHistoryReminderParental_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr":"user.studies[\"CMI-OSTEO\"].isGovernedParticipant()",
      "cancelExpr":"user.studies[\"CMI-OSTEO\"].forms[\"FAMILY_HISTORY_SELF\"].isStatus(\"COMPLETE\")",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    }

    # GERMLINE_CONSENT_ADDENDUM email events
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.GermlineAddendumRequired}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.GermlineAddendumRequired_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
              { "emailTemplate": ${emails.GermlineAddendumComplete}, "language": "en", "isDynamic": false },
              { "emailTemplate": ${emails.GermlineAddendumComplete_es}, "language": "es", "isDynamic": true }
            ],
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM"].questions["ADDENDUM_CONSENT_BOOL"].answers.hasTrue()""",
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
            "templates": [
              { "emailTemplate": ${emails.GermlineAddendumComplete}, "language": "en", "isDynamic": false },
              { "emailTemplate": ${emails.GermlineAddendumComplete_es}, "language": "es", "isDynamic": true }
            ],
        "pdfAttachments": [{ "pdfName": "osproject-germline-consent-addendum-disagree", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM"].questions["ADDENDUM_CONSENT_BOOL"].answers.hasFalse()""",
      "order": 2
    },

    # GERMLINE_CONSENT_ADDENDUM_PEDIATRIC email events
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.ParentalGermlineAddendumRequired}, "language": "en", "isDynamic": false },
          { "emailTemplate": ${emails.ParentalGermlineAddendumRequired_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
            "templates": [
              { "emailTemplate": ${emails.ParentalGermlineAddendumComplete}, "language": "en", "isDynamic": false },
              { "emailTemplate": ${emails.ParentalGermlineAddendumComplete_es}, "language": "es", "isDynamic": true }
            ],
        "pdfAttachments": [{ "pdfName": "osproject-germline-consent-addendum-pediatric", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM_PEDIATRIC"].questions["ADDENDUM_CONSENT_BOOL_PEDIATRIC"].answers.hasTrue()""",
      "order": 2
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "COMPLETE"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
            "templates": [
              { "emailTemplate": ${emails.ParentalGermlineAddendumComplete}, "language": "en", "isDynamic": false },
              { "emailTemplate": ${emails.ParentalGermlineAddendumComplete_es}, "language": "es", "isDynamic": true }
            ],
        "pdfAttachments": [{ "pdfName": "osproject-germline-consent-addendum-pediatric-disagree", "generateIfMissing": true }]
      },
      "dispatchToHousekeeping": true,
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM_PEDIATRIC"].questions["ADDENDUM_CONSENT_BOOL_PEDIATRIC"].answers.hasFalse()""",
      "order": 3
    }

    # reminder emails
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
            "templates": [
              { "emailTemplate": ${emails.GermlineAddendumReceived}, "language": "en", "isDynamic": false },
              { "emailTemplate": ${emails.GermlineAddendumReceived_es}, "language": "es", "isDynamic": true }
            ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
            "templates": [
              { "emailTemplate": ${emails.GermlineAddendumReceived}, "language": "en", "isDynamic": false },
              { "emailTemplate": ${emails.GermlineAddendumReceived_es}, "language": "es", "isDynamic": true }
            ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    #pediatric reminders
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
            "templates": [
              { "emailTemplate": ${emails.ParentalGermlineAddendumReceived}, "language": "en", "isDynamic": false },
              { "emailTemplate": ${emails.ParentalGermlineAddendumReceived_es}, "language": "es", "isDynamic": true }
            ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM_PEDIATRIC"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.one},
      "dispatchToHousekeeping": true,
      "order": 1
    },
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "GERMLINE_CONSENT_ADDENDUM_PEDIATRIC",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
            { "emailTemplate": ${emails.ParentalGermlineAddendumReceived}, "language": "en", "isDynamic": false },
            { "emailTemplate": ${emails.ParentalGermlineAddendumReceived_es}, "language": "es", "isDynamic": true }
          ],
        "pdfAttachments": []
      },
      "cancelExpr": """user.studies["CMI-OSTEO"].forms["GERMLINE_CONSENT_ADDENDUM_PEDIATRIC"].isStatus("COMPLETE")""",
      "delaySeconds": ${delay.weeks.two},
      "dispatchToHousekeeping": true,
      "order": 1
    },

    #somatic_results email events
    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "SOMATIC_RESULTS",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          { "emailTemplate": ${emails.somaticResultsInvitation}, "language": "en", "isDynamic": true },
          { "emailTemplate": ${emails.somaticResultsInvitation_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr": """user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 1
    },

    {
      "trigger": {
        "type": "ACTIVITY_STATUS",
        "activityCode": "SOMATIC_RESULTS",
        "statusType": "CREATED"
      },
      "action": {
        "type": "SENDGRID_EMAIL",
        "templates": [
          {"emailTemplate": ${emails.somaticResultsChildInvitation}, "language": "en", "isDynamic": true },
          {"emailTemplate": ${emails.somaticResultsChildInvitation_es}, "language": "es", "isDynamic": true }
        ],
        "pdfAttachments": []
      },
      "preconditionExpr": """!user.studies["CMI-OSTEO"].forms["CONSENT"].hasInstance()""",
      "dispatchToHousekeeping": true,
      "order": 2
    }

  ]
}
