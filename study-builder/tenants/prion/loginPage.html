<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Prion Registry</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link href="https://fonts.googleapis.com/css?family=Raleway:300i,300,400,500,700" rel="stylesheet">
    <link id="app-favicon" rel="icon" type="image/x-icon" href="https://storage.googleapis.com/dev-prion-assets/images/favicon.ico">
    <script src="https://kit.fontawesome.com/6ff953c590.js" crossorigin="anonymous"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!--Material icons-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>
<body>

<!--[if IE 8]>
<script src="//cdnjs.cloudflare.com/ajax/libs/ie8/0.2.5/ie8.js"></script>
<![endif]-->

<!--[if lte IE 9]>
<script src="https://cdn.auth0.com/js/base64.js"></script>
<script src="https://cdn.auth0.com/js/es5-shim.min.js"></script>
<![endif]-->

<script src="https://cdn.auth0.com/js/lock/11.9/lock.min.js"></script>

<style type="text/css">

    /* Basic element styling */
    @media only screen and (min-width: 1026px) {
        html {
            font-size: 18px !important;
        }
    }
    html,
    body {
        margin: 0;
        padding: 0 !important;
        height: 100%;
        font-size: 15px;
        background-color:#f9f3e8;
    }

    body, a {
        font-family: 'Raleway', sans-serif !important;
    }
    h2 {
        font-size: 1.5rem !important;
        font-family: 'Raleway', sans-serif !important;
        font-weight: 500 !important;
        margin-bottom: 15px !important;
        text-align: left !important;
        margin-top: 20px !important;
        color: #333 !important;
        max-width: 804px;
    }
    h5 {
        font-size: 1rem;
        font-family: 'Raleway', sans-serif;
        line-height: 1.5rem;
        font-weight: 400 !important;
        color: #333 !important;
        margin-top: 0 !important;
        margin-bottom: 10px !important;
        text-align: left !important;
        max-width: 804px;
    }
    p {
        font-size: 1rem;
        font-family: 'Raleway', sans-serif;
        line-height: 1.5rem;
        font-weight: 400 !important;
        display: block !important;
        color: #000000 !important;
    }

    span {
        font-family: 'Raleway', sans-serif !important;
    }

    a,
    button {
        text-decoration: none !important;
        outline: 0 !important;
    }

    button {
        max-width: 804px;
    }

    .auth0-lock.auth0-lock .auth0-lock-input-block {
        max-width: 804px;
    }

    a:hover,
    a:active,
    a:focus {
        outline: 0;
    }

    /* Margins and padding */
    .NoMargin {
        margin: 0 !important;
    }

    .NoTopMargin {
        margin-top: 0 !important;
    }

    .TopPaddingTen {
        padding-top: 10px;
    }

    .NoPadding {
        padding: 0 !important;
    }

    /* Auth0 element styling */
    .auth0-lock.auth0-lock .auth0-lock-widget {
        max-height: unset !important;
    }

    .auth0-lock-back-button {
        z-index: 2000 !important;
    }

    .auth0-lock .auth0-lock-opened-in-frame .auth0-lock-with-tabs {
        height:available !important;
    }

    .auth0-lock-header-welcome, .auth0-lock-header{
        background-color: #F2B815 !important;
        border-top-left-radius: 0 !important;
        border-top-right-radius: 0 !important;
        padding: 0 !important;
    }

    .auth0-lock.auth0-lock, .auth0-lock.auth0-lock.auth0-lock-opened .auth0-lock-widget
    {
        position: static !important;
    }

    @media screen and (max-width: 480px) {
        .auth0-lock.auth0-lock.auth0-lock-opened .auth0-lock-widget {
            position: static !important;
        }
    }

    .auth0-lock.auth0-lock .auth0-lock-overlay {
        position: static !important;
        display: none !important;
        overflow: hidden !important;
        height: 0px !important;
        width: 0px !important;
    }

    .auth0-lock.auth0-lock, .auth0-lock.auth0-lock * {
        box-sizing: border-box !important;
    }

    .auth0-lock.auth0-lock .auth0-lock-header-bg {
        height: 1% !important;
    }

    .auth0-lock-header-logo {
        text-align: left;
        margin-left: 80px !important;
        height: 55px !important;
    }

    .auth0-lock.auth0-lock .auth0-lock-header {
        height: unset;
    }

    .auth0-lock-cred-pane .auth0-lock-quiet, .auth0-lock-cred-pane, .auth0-lock.auth0-lock.auth0-lock-opened .auth0-lock-widget,
    .auth0-lock-widget-container, .auth0-lock-center {
        background-color:#f9f3e8 !important;
    }

    .auth0-lock.auth0-lock.auth0-lock-opened .auth0-lock-widget,
    .auth0-lock-widget-container, .auth0-lock-center{
        min-height: 100% !important;
        width: 100% !important;
        margin-left: 0 !important;
        margin-right: 0 !important;
    }

    .auth0-lock.auth0-lock .auth0-lock-submit {
        padding-left: 30px;
        padding-right: 30px;
        padding-top:10px;
        width: 100%;
        box-sizing: border-box;
        background-color: #82B547 !important;
        margin-bottom: 25px;
        display: block !important;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
    }

    .auth0-lock-content {
        padding: 0 !important;
        margin: 0;
    }

    .auth0-lock.auth0-lock.auth0-lock-opened.auth0-lock-with-tabs .auth0-lock-body-content {
        padding-top: unset !important;
    }

    .auth0-lock-alternative-link {
        font-size: 0.75rem;
        font-weight: 300;
        font-style: italic;
        color: #717174;
    }

    .auth0-lock-alternative-link:hover {
        color: #82B547;
    }

    .auth0-lock.auth0-lock .auth0-lock-form .auth0-lock-alternative .auth0-lock-alternative-link {
        color: #717174;
        font-size: 0.75rem;
        line-height: 1.42857143;
    }

    .auth0-lock-input-wrap {
        padding-left: 0 !important;
        border-color: rgb(206, 206, 206) !important;
    }

    .auth0-lock-input-wrap.auth0-lock-focused {
        border-color: #a0a0a0 !important;
    }

    .auth0-lock-error-msg:after {
        content: unset;
    }

    .auth0-lock.auth0-lock .auth0-lock-form p {
        text-align: left !important;
    }

    .auth0-lock-input-block.auth0-lock-input-password.auth0-lock-error {
        font-family: 'Raleway', sans-serif;
        font-size: 12px;
        color: #f00;
    }

    .auth0-lock-input-block.auth0-lock-input-email {
        margin-top: 0 !important;
        margin-bottom: 0 !important;
    }

    @media (min-width: 481px) {
        .auth0-lock-error-msg span {
            padding: unset !important;
        }

        .auth0-lock-error-msg {
            color: #f00;
            background: none !important;
            box-shadow: none !important;
            position: relative !important;
            left: unset !important;
            border-radius: unset !important;
            top: unset !important;
            margin: 5px 0 0 0 !important;
        }
    }

    .auth0-global-message.auth0-global-message-error a {
        color: #ffffff;
    }

    /* Container element styling */
    .MiddleContainer {
        background-color: #ffffff;
        margin-left: 50px;
        margin-right: 50px;
        padding: 30px 45px 1px;
        min-height: calc(100vh - 248px);
    }

    @media only screen and (max-width: 767px) {
        .MiddleContainer {
            margin-left: 0px;
            margin-right: 0px;
        }
    }

    @media only screen and (max-width: 992px) and (min-width: 768px) {
        .MiddleContainer {
            margin-left: 25px;
            margin-right: 25px;
        }
    }

    /* Styling options */
    .Color--green {
        color: #82B547 !important;
        font-size: 15px;
        font-weight: 900;
    }

    .flex-row {
        flex-flow: row !important;
        display: flex !important;
    }

    /* Specific element styling */
    .Input-label {
        color: rgb(51, 51, 51);
        font-size: 0.9rem;
        font-weight: 400;
        margin-bottom: 10px;
        margin-top: 0;
        margin-right: 10px;
        font-family: 'Raleway', sans-serif !important;
    }

    .tooltip {
        box-sizing: border-box !important;
        display: inline-block !important;
        font-stretch: 100%;
        margin-top: 10px;
    }

    .tooltip .tooltiptext {
        background-color: #efefef !important;
        color: #717174;
        font-family: 'Raleway', sans-serif !important;
        font-size: 0.7rem;
        width: 250px !important;
        visibility: hidden;
        position: absolute;
        z-index: 1;
        opacity: 0;
        transition: opacity 0.3s;
        font-weight: 400;
        line-height: 1.42857143;
        border-radius: 4px;
        padding: 3px 8px;
        left: -46px;
        top: -15px;
    }

    .tooltip .tooltiptext::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #efefef transparent transparent transparent;
    }

    .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
    }

    i.fa {
        font-family: 'Font Awesome 5 Pro' !important;
        display: inline-block !important;
        position: unset;
        opacity: unset;
    }

    /* Header */
    .auth0-lock.auth0-lock .auth0-lock-header {
        height: unset;
        text-align: unset;
        font-size: 15px !important;
        font-family: 'Raleway', sans-serif !important;
        background-color: #F2B815 !important;
        border-top-left-radius: 0 !important;
        border-top-right-radius: 0 !important;
        padding: 0 !important;
    }

    .auth0-lock.auth0-lock .auth0-lock-header-bg {
        height: 1% !important;
    }

    .auth0-lock-header-logo {
        text-align: left;
        margin-left: 80px !important;
        height: 55px !important;
    }

    .loginHeader {
        line-height: 1.1 !important;
        margin-top: 20px !important;
    }

    .Header {
        height: auto;
        width: 100%;
        z-index: 1000;
    }

    .Header-background {
        position: relative;
        padding: 30px 80px 20px 80px;
        margin: 0;
        background: #F2B816 none;
        border-radius: 0;
        border: none;
        -webkit-box-shadow: none;
        box-shadow: none;
        z-index: 100;
        width: 100%;
    }

    .Header-logo img {
        height: 55px;
        width: 232.19px;
    }

    .Header-hamburger {
        padding: 9px 10px !important;
        margin: 8px 0 0 8px !important;
        background-color: transparent ;
        background-image: none;
        border: 2px solid #ffffff !important;
        border-radius: 4px;
        transition: all 0.5s ease;
    }

    .Header-hamburger .icon-bar,
    .Header-hamburger:hover .icon-bar,
    .Header-hamburger:focus .icon-bar,
    .Header-hamburger:active .icon-bar {
        background-color: #ffffff !important;
    }

    .Header-hamburger:hover {
        background-color: transparent !important;
        box-shadow: 2px 2px 4px #a88838;
    }

    .Header-hamburger:focus {
        background-color: transparent !important;
    }

    .Header-collapse {
        padding: 0;
        overflow-x: visible;
        border-top: none;
        -webkit-box-shadow: none;
        box-shadow: none;
    }

    .Header-collapse.in,
    .Header-collapse.collapsing {
        overflow: hidden;
    }

    .Header-collapse.in,
    .Header-collapse.collapsing {
        background: #F2B816;
    }

    .Header-collapse.in li.Nav-item,
    .Header-collapse.collapsing li.Nav-item {
        display: block;
        width: 100%;
        float: right;
        text-align: right;
    }

    .Header-collapse.in li.Nav-item-JoinUs,
    .Header-collapse.collapsing li.Nav-item-JoinUs {
        width: auto;
        text-align: center;
        padding-top: 10px !important;
    }

    .Nav-item:nth-of-type(4) {
        padding-left: 33px !important;
    }

    @media only screen and (min-width: 1026px) and (max-width: 1200px) {
        .Header-background {
            padding: 30px 40px 20px 80px !important;
        }
        .navbar-nav {
            float: right !important;
            width: 649px;
        }
    }

    @media only screen and (min-width: 993px) and (max-width: 1025px) {
        .Header-background {
            padding: 30px 40px 20px 80px !important;
        }
        .navbar-nav {
            float: right !important;
            width: 584px;
        }
    }

    @media only screen and (min-width: 768px) and (max-width: 992px) {
        .Header-background {
            padding: 25px 0 0 0 !important;
        }
        .navbar-header {
            padding: 0 10px 25px 25px !important;
        }
        .navbar-collapse {
            padding: 0 25px 10px 25px !important;
        }
        .navbar-nav {
            width: 415px !important;
        }
    }

    .Nav ul {
        list-style: none;
        float: right;
    }

    .Nav-item {
        display: inline;
        padding: 0 0 0 30px !important;
        font-weight: 500;
    }

    .Nav-item:first-of-type {
        padding-left: 20px !important;
    }

    #JoinUs {
        padding: 12px 30px !important;
    }

    .Nav-itemLink {
        cursor: pointer;
        color: #ffffff !important;
        font-size: 1rem;
        line-height: 3.2rem !important;
        text-shadow: none;
        padding: 0 !important;
        transition: all 0.3s ease-in-out;
    }

    .Nav-itemLink--active {
        font-weight: 700;
        color: #a88838 !important;
    }

    .Nav-itemLink:hover {
        color: #a88838 !important;
    }

    @media only screen and (max-width: 1025px) {
        .Header-logo {
            margin: 0;
        }
    }

    .Button {
        border-radius: 2px;
        font-weight: 500;
        font-size: 1rem;
        padding: 12px 30px;
        margin-bottom: 15px;
        cursor: pointer;
        transition: all 0.3s ease-in-out;
        text-align: center;
        margin-top: 5px;
    }

    .Button:hover {
        box-shadow: 1px 1px 5px #9E9E9E;
    }

    .Button--secondaryWhite,
    .Button--secondaryWhite:active,
    .Button--secondaryWhite:focus {
        border-radius: 3px;
        background-color: transparent !important;
        border: 2px solid #ffffff;
        color: #ffffff !important;
    }

    .Button--active {
        font-weight: 700;
        color: #a88838 !important;
        border: 2px solid #a88838 !important;
    }

    /* Footer styling */
    .Footer {
        position: relative;
        bottom: 0;
        width: 100%;
        min-height: 90px;
        padding: 20px 50px;
        z-index: 2;
        background-color: #f9f3e8;
        margin: 0 0 0 0;
        clear: both;
    }

    .Footer-left img {
        height: 50px;
    }

    .Footer-left {
        padding-left: 20px;
        padding-top: 5px;
        height: 90px;
    }

    p.Footer-contact {
        font-size: 0.9rem !important;
        color: #727272 !important;
        font-weight: 500 !important;
        margin-top: 10px;
        margin-bottom: 0;
    }

    .Footer-links {
        height: 90px;
        padding: 31px 0 0;
    }

    .Footer-text {
        font-size: 0.9rem !important;
        color: #727272;
        margin-top: 0;
        margin-bottom: 0;
    }

    .Footer-link {
        font-weight: 500;
        color: #727272;
        display: inline;
        cursor: pointer;
        text-align: right;
        transition: color 0.2s linear;
        padding-left: 30px;
        align-items: unset;
        border: none;
        border-image-width: 0;
        white-space: nowrap;
    }

    .Footer-link:hover{
        color: #82B547 !important;
    }

    .Footer-arrow {
        font-size: 0.5rem;
        margin: 0 5px 5px 30px;
    }

    .Float--right {
        float: right !important;
    }

    .backToTopText {
        font-weight: 500 !important;
    }

    .backToTopLink {
        padding: 0;
        align-items: flex-start;
    }

    @media only screen and (max-width: 767px) {
        .Footer {
            padding: 20px 25px 20px 25px;
            min-height: 280px;
        }
        .Footer-left {
            padding-top: 6px;
            padding-left: 0;
            height: unset;
        }
        .Footer-links {
            padding-top: 0;
            height: unset;
        }
        .Footer-text {
            margin-top: 5px;
        }
        .Footer-text,
        .Footer-link {
            display: block;
            float: left !important;
            text-align: left;
            padding-left: 0;
            width: 100%;
        }
        .Footer-text {
            margin-top: 20px;
        }
        .Footer-arrow {
            margin-left: 0;
        }
    }

    @media only screen and (max-width: 991px) and (min-width: 768px) {
        .Footer {
            padding: 20px 25px 20px 25px;
        }
        .Footer-left {
            padding-left: 0;
        }
    }

    @media only screen and (max-width: 1199px) and (min-width: 992px) {
        .Footer-links {
            padding-top: 20px;
        }
    }

    .SimpleButton {
        line-height: 3.2rem !important;
        background: none;
        border: none;
        padding: 0;
        outline: none;
        font-size: 1rem;
        transition: color 0.3s ease;
        cursor: pointer;
        font-weight: 500;
        text-decoration: none;
        color: #ffffff !important;
        margin-top: 5px;
    }

    .SimpleButton:hover {
        color: #a88838 !important;
        text-decoration: none;
    }

    .SimpleButton:active {
        text-decoration: none;
        font-weight: 700;
        color: #a88838 !important;
    }

    /* Language selector styles */
    .SimpleButton .ddp-globe {
        stroke: #ffffff;
        fill: transparent;
        vertical-align: middle;
        transition: stroke 0.3s ease;
    }

    .SimpleButton:hover .ddp-globe {
        stroke: #a88838;
        fill: transparent;
    }

    .SimpleButton:active .ddp-globe {
        stroke: #a88838;
        fill: transparent;
    }

    .ddp-current-language {
        vertical-align: middle;
    }

    i.ddp-dropdown-arrow {
        vertical-align: middle;
    }

    .dropdown-content {
        background-color: rgb(255, 255, 255);
        border-radius: 4px;
        box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12);
        box-sizing: border-box;
        color: rgb(51, 51, 51);
        display: none;
        padding: 10px !important;
        position: fixed;
        min-width: 112px;
        max-width: 280px;
        font-size: 14px;
        font-weight: 400;
    }

    dropdown-content.show {
        display: block;
    }

    button.language-menu-item {
        width: 100%;
        display: block;
        line-height: 48px;
        height: 48px;
        text-align: left;
        max-width: 100%;
        padding: 0 !important;
        background-color: white;
        border: none !important;
        color: rgba(0, 0, 0, 0.87);
    }

    button.language-menu-item:hover {
        background-color: #F2F2F2;
    }

    button.language-menu-item:focus {
        background-color: #DEDEDE;
    }

    button.language-menu-item:first-of-type {
        line-height: 32px !important;
        padding-bottom: 16px !important;
    }

    button.language-menu-item:last-of-type {
        line-height: 31px !important;
        padding-top: 16px !important;
    }
</style>

<script>
    // Decode utf8 characters properly
    var config = JSON.parse(decodeURIComponent(escape(window.atob('@@config@@'))));
    config.extraParams = config.extraParams || {};
    var mode = config.extraParams.mode;
    var languageCode = config.extraParams.language;
    var headerLogo = 'https://storage.googleapis.com/dev-prion-assets/images/prion-logo.svg';
    var studyColor = '#DDDDDD';

    var mainUrl = '';
    var authLoc = Math.max(config.callbackURL.indexOf('/auth'), config.callbackURL.indexOf('/login-landing'));
    if (authLoc === -1) {
        mainUrl = config.callbackURL;
    }
    else {
        mainUrl = config.callbackURL.substring(0,authLoc);
    }

    var loginUrl = `${mainUrl}/change-language-redirect?language=${languageCode}&destination=login-landing/login`;
    var registerUrl = `${mainUrl}/change-language-redirect?language=${languageCode}&destination=redirect-join`;
    var contactEmail = 'info@prionregistry.org';

    var connection = config.connection;
    var prompt = !prompt;
    var languageDictionary;
    var language;
    var showPasswordRecentText = false;
    var doNotShowRegLink = false;
    var dictionaries = {};
    dictionaries['en'] = {
        title: ' ',
        blankErrorHint: 'Please fill out this field.',
        emailInputPlaceholder: '   ',
        passwordInputPlaceholder: '    ',
        lastLoginInstructions: 'Last time you signed in with',
        signUpTitle: ' ',
        loginAtLabel: 'Sign in at %s',
        signUpLabel: 'Join Us',
        signUpSubmitLabel: 'Join Us',
        databaseSignUpInstructions: '<h2 class="Auth0Title">Join Us</h2> <h5>Do you or a relative of yours have prion disease? Tell us about it and join us making a difference...</h5> <h5>Please fill out the form below to register. We will use this account to communicate with you regarding the Prion Registry.</h5>',
        loginTitle: ' ',
        loginLabel: 'Sign In',
        loginSubmitLabel: 'Sign In',
        forgotPasswordTitle: ' ',
        forgotPasswordAction: 'Forgot your password?',
        forgotPasswordInstructions: '<h2 class="Auth0Title">Forgot your password?</h2> <h5>Please enter your email address and we will send you password reset instructions.</h5>',
        forgotPasswordSubmitLabel: 'Submit',
        firstNameHint: 'Please fill out this field.',
        lastNameHint: 'Please fill out this field.',
        alreadyRegisteredText: 'Already registered? Sign In here',
        passwordTooltipText: 'Password must be at least 8 characters long.',
        loginDescriptionText: 'You can log into the Prion Registry using your email account.',
        emailPrompt: 'Email Address*',
        passwordPrompt: 'Password*',
        firstNamePrompt: 'First Name*',
        lastNamePrompt: 'Last Name*',
        registerMessageText: 'Don\'t have an account? Join us here',
        passwordResetSuccessMessage: 'Already registered? Sign In here',
        logoAlt: 'Prion Registry Logo',
        learnMore: 'Learn More',
        signIn: 'Sign In',
        joinUs: 'Join Us',
        home: 'Home',
        studyListing: 'Study Listing',
        backToTop: 'Back to top',
        privacyPolicy: 'Privacy Policy',
        contactUs: 'Contact us: ',
        successForgotPassword: 'If you have previously registered, please check your email to reset your password.',
        languageSelection: 'language selection',
        invalidErrorHint: 'Invalid',
        unrecoverableError: 'Something went wrong. Please contact technical support.',
        error: {
            forgotPassword: {
                too_many_requests: 'We\'re sorry. There are too many requests right now. Please reload the page and try again. If this persists, please try again later.',
                'lock.fallback': 'We\'re sorry, something went wrong when requesting the password change.'
            }
        },
        login: {
            password_leaked: 'We have detected a potential security issue with this account. To protect your account, we have blocked this login. An email was sent with instruction on how to unblock your account.',
            too_many_attempts: 'Your account has been blocked after multiple consecutive login attempts.',
            'lock.fallback': 'We\'re sorry, something went wrong when attempting to log in.',
            'lock.invalid_email_password': 'Wrong email or password.',
            'lock.network': 'We could not reach the server. Please check your connection and try again.'
        }
    };

    dictionaries['es'] = {
        title: ' ',
        blankErrorHint: 'Complete este campo.',
        emailInputPlaceholder: '   ',
        passwordInputPlaceholder: '    ',
        lastLoginInstructions: 'La última vez inició sesión con',
        signUpTitle: ' ',
        loginAtLabel: 'Iniciar sesión en %s',
        signUpLabel: 'Súmese',
        signUpSubmitLabel: 'Súmese',
        databaseSignUpInstructions: '<h2 class="Auth0Title">Súmese</h2> <h5>¿Usted o algún familiar suyo tiene enfermedad priónica? Cuéntenos y súmese para lograr un cambio positivo...</h5> <h5>Complete el siguiente formulario para registrarse. Utilizaremos esta cuenta para comunicarnos con usted con respecto a Prion Registry.</h5>',
        loginTitle: ' ',
        loginLabel: 'Iniciar sesión',
        loginSubmitLabel: 'Iniciar sesión',
        loginWithLabel: 'Iniciar sesión con %s',
        forgotPasswordTitle: ' ',
        forgotPasswordAction: '¿Olvidó su contraseña?',
        forgotPasswordInstructions: '<h2 class="Auth0Title">¿Olvidó su contraseña?</h2> <h5>Ingrese su dirección de correo electrónico y le enviaremos instrucciones para restablecer la contraseña.</h5>',
        forgotPasswordSubmitLabel: 'Enviar',
        firstNameHint: 'Complete este campo.',
        lastNameHint: 'Complete este campo.',
        alreadyRegisteredText: '¿Ya se ha registrado? Inicie sesión aquí',
        passwordTooltipText: 'La contraseña debe tener al menos 8 caracteres.',
        oldPasswordTooltipText: 'La contraseña debe tener al menos 8 caracteres y como mínimo un número, una letra en mayúscula y una en minúscula.',
        loginDescriptionText: 'Puede iniciar sesión en Prion Registry con su cuenta de correo electrónico.',
        emailPrompt: 'Dirección de correo electrónico*',
        passwordPrompt: 'Contraseña*',
        firstNamePrompt: 'Nombre*',
        lastNamePrompt: 'Apellido*',
        registerMessageText: '¿No tiene una cuenta? Súmese aquí',
        passwordResetSuccessMessage: '¿Ya se ha registrado? Inicie sesión aquí',
        logoAlt: 'Logotipo de Prion Registry',
        learnMore: 'Más información',
        signIn: 'Iniciar sesión',
        joinUs: 'Súmese',
        home: 'Página principal',
        studyListing: 'Lista de estudios',
        backToTop: 'Volver arriba',
        privacyPolicy: 'Política de privacidad',
        contactUs: 'Comuníquese con nosotros:',
        successForgotPassword: 'Si ya se registró, revise su correo electrónico para restablecer la contraseña.',
        languageSelection: 'idioma seleccionado',
        invalidErrorHint: 'No válido.',
        unrecoverableError: 'Se produjo un error. Comuníquese con el servicio de asistencia técnica.',
        error: {
            forgotPassword: {
                too_many_requests: 'Disculpe. En este momento hay demasiadas solicitudes. Actualice la página y vuelva a intentarlo. Si el problema continúa, inténtelo de nuevo más tarde.',
                'lock.fallback': 'Disculpe, se produjo un error al solicitar el cambio de contraseña.'
            }
        },
        login: {
            password_leaked: 'Detectamos un posible problema de seguridad con esta cuenta. Para proteger su cuenta, hemos bloqueado este inicio de sesión. Se envió un correo electrónico con instrucciones para desbloquear su cuenta.',
            too_many_attempts: 'Su cuenta se bloqueó tras varios intentos fallidos de iniciar sesión.',
            'lock.fallback': 'Disculpe, se produjo un error al intentar iniciar sesión.',
            'lock.invalid_email_password': 'Correo electrónico o contraseña incorrecta.',
            'lock.network': 'No pudimos comunicarnos con el servidor. Verifique el estado de su conexión y vuelva a intentarlo.'
        }
    };
    dictionaries['he'] = {
        title: ' ',
        blankErrorHint: 'יש למלא שדה זה.',
        emailInputPlaceholder: '   ',
        passwordInputPlaceholder: '    ',
        lastLoginInstructions: 'בפעם הקודמת נכנסתם עם',
        signUpTitle: ' ',
        loginAtLabel: 'כניסה ב-%s',
        signUpLabel: 'הצטרפו אלינו',
        signUpSubmitLabel: 'הצטרפו אלינו',
        databaseSignUpInstructions: '<h2 class="Auth0Title">הצטרפו אלינו</h2> <h5>האם אתם או קרוב משפחתכם חולים במחלת פריון? ספרו לנו על כך והצטרפו אלינו ביצירת שינוי...</h5> <h5>מלאו את הטופס להלן כדי להירשם. אנו נשתמש בחשבון זה כדי לתקשר אתכם בנוגע ל-Prion Registry.</h5>',
        loginTitle: ' ',
        loginLabel: 'כניסה',
        loginSubmitLabel: 'כניסה',
        loginWithLabel: 'היכנסו עם %s',
        forgotPasswordTitle: ' ',
        forgotPasswordAction: 'שכחתם את הסיסמה?',
        forgotPasswordInstructions: '<h2 class="Auth0Title">שכחתם את הסיסמה?</h2> <h5>הזינו את כתובת הדוא\'ל שלכם ואנו נשלח לכם הוראות לאיפוס סיסמה.</h5>',
        forgotPasswordSubmitLabel: 'שלח',
        firstNameHint: 'יש למלא שדה זה.',
        lastNameHint: 'יש למלא שדה זה.',
        alreadyRegisteredText: 'כבר רשומים? היכנסו כאן',
        passwordTooltipText: 'הסיסמה חייבת להיות באורך של 8 תווים לפחות.',
        oldPasswordTooltipText: 'הסיסמה חייבת להיות באורך של 8 תווים לפחות ולכלול לפחות מספר אחד, אות רישית אחת ואות קטנה אחת.',
        loginDescriptionText: 'באפשרותכם להתחבר ל-Prion Registry באמצעות כתובת הדוא\'ל שלכם.',
        emailPrompt: 'כתובת דוא\'ל*',
        passwordPrompt: 'סיסמה*',
        firstNamePrompt: 'שם פרטי*',
        lastNamePrompt: 'שם משפחה*',
        registerMessageText: 'אין לכם חשבון? הצטרפו אלינו כאן',
        passwordResetSuccessMessage: 'כבר רשומים? היכנסו כאן',
        logoAlt: 'סמל של Prion Registry',
        learnMore: 'למידע נוסף',
        signIn: 'כניסה',
        joinUs: 'הצטרפו אלינו',
        home: 'דף בית',
        studyListing: 'רשימת מחקרים',
        backToTop: 'חזור לראש הדף',
        privacyPolicy: 'מדיניות פרטיות',
        contactUs: 'צרו קשר:',
        successForgotPassword: 'אם נרשמתם בעבר, בדקו את הדוא\'ל שלכם כדי לאפס את הסיסמה.',
        languageSelection: 'בחירת שפה',
        invalidErrorHint: 'לא תקף',
        unrecoverableError: 'משהו השתבש. צרו קשר עם התמיכה הטכנית.',
        error: {
            forgotPassword: {
                too_many_requests: 'אנו מצטערים. ישנן בקשות רבות מדי כעת. טענו מחדש את הדף ונסו שוב. אם הבעיה נמשכת, נסו שוב מאוחר יותר.',
                'lock.fallback': 'מצטערים, משהו השתבש במהלך הבקשה להחלפת סיסמה.'
            }
        },
    login: {
        password_leaked: 'זיהינו בעיית אבטחה אפשרית בחשבון זה. כדי להגן על חשבונכם חסמנו התחברות זו. שלחנו הודעת דוא\'ל עם הוראות להסרת החסימה מחשבונכם.',
        too_many_attempts: 'חשבונכם נחסם לאחר מספר נסיונות התחברות רצופים.',
        'lock.fallback': 'מצטערים, משהו השתבש במהלך ניסיון ההתחברות.',
        'lock.invalid_email_password': 'דוא\'ל או סיסמה שגויים.',
        'lock.network': 'לא הצלחנו להשיג את השרת. בדקו את החיבור שלכם ונסו שוב.'
        }
    };
    dictionaries['zh'] = {
        title: ' ',
        blankErrorHint: '请填写此字段。',
        emailInputPlaceholder: '   ',
        passwordInputPlaceholder: '    ',
        lastLoginInstructions: '您上次登录时使用',
        signUpTitle: ' ',
        loginAtLabel: '登录位置为 %s',
        signUpLabel: '加入我们',
        signUpSubmitLabel: '加入我们',
        databaseSignUpInstructions: '<h2 class="Auth0Title">加入我们</h2><h5>是否您本人或者您的亲属患有朊蛋白病？请介绍您的情况，加入我们并为朊蛋白病研究做出一份贡献...</h5> <h5>请填写以下表格进行注册。日后我们将使用此帐户就朊蛋白病注册库事宜与您联系。</h5>',
        loginTitle: ' ',
        loginLabel: '登录',
        loginSubmitLabel: '登录',
        loginWithLabel: '以 %s 登录',
        forgotPasswordTitle: ' ',
        forgotPasswordAction: '忘记密码？',
        forgotPasswordInstructions: '<h2 class="Auth0Title">忘记密码？</h2> <h5>请输入您的电子邮箱地址，我们会向此邮箱发送密码重置操作指南。</h5>',
        forgotPasswordSubmitLabel: '提交',
        firstNameHint: '请填写此字段。',
        lastNameHint: '请填写此字段。',
        alreadyRegisteredText: '已经注册？在此登录',
        passwordTooltipText: '密码长度不得少于 8 个字符。',
        oldPasswordTooltipText: '密码长度不得少于 8 个字符，并包含至少一个数字、一个大写字母和一个小写字母。',
        loginDescriptionText: '您可以使用电子邮箱帐户登录朊蛋白病注册库。',
        emailPrompt: '电子邮箱地址*',
        passwordPrompt: '密码*',
        firstNamePrompt: '名字*',
        lastNamePrompt: '姓氏*',
        registerMessageText: '您没有帐户？点击此处加入我们',
        passwordResetSuccessMessage: '已经注册？在此登录',
        logoAlt: '朊蛋白病注册库徽标',
        learnMore: '了解更多',
        signIn: '登录',
        joinUs: '加入我们',
        home: '主页',
        studyListing: '研究列表',
        backToTop: '返回顶部',
        privacyPolicy: '隐私政策',
        contactUs: '联系我们：',
        successForgotPassword: '如果您之前已经注册，请查看您的电子邮件以重置密码。',
        languageSelection: '语言选择',
        invalidErrorHint: '无效',
        unrecoverableError: '出现了错误。请联系技术支持。',
        error: {
            forgotPassword: {
                too_many_requests: '很抱歉。目前的请求过多。请刷新页面，然后再试一次。如果持续发生，请稍后再试。',
                'lock.fallback': '很抱歉，请求更改密码时出现问题。'
            }
        },
        login: {
            password_leaked: '我们检测到此帐户存在潜在的安全问题。为保护您的帐户，我们已阻止此次登录。已发送一封电子邮件，其中包含有关如何解锁帐户的说明。',
            too_many_attempts: '多次连续登录尝试后，您的帐户已被锁定。',
            'lock.fallback': '很抱歉，尝试登录时出现问题。',
            'lock.invalid_email_password': '电子邮箱或者密码错误。',
            'lock.network': '我们无法连接到服务器。请检查您的连接，然后重试。'
        }
    };
    if ('en' !== languageCode && 'es' !== languageCode && 'he' !== languageCode && 'zh' !== languageCode) {
        console.log('invalid language code; using default');
        languageCode = 'en';
    }

    const html = this.document.querySelector('html');
    html.setAttribute('lang', languageCode);

    if ('he' === languageCode) {
        html.setAttribute('dir', 'rtl');
    }

    languageDictionary = dictionaries[languageCode];
    languageDictionary.error = languageDictionary.error || {};
    languageDictionary.error.signUp = languageDictionary.error.signUp || {};
    languageDictionary.error.signUp.user_exists = '<a class="error-link-header" href="' + loginUrl + '">' + languageDictionary.alreadyRegisteredText + '</a>';
    languageDictionary.success = {
        forgotPassword: languageDictionary.successForgotPassword
    };
    languageDictionary.displayNames = {
        en: 'English',
        he: 'עברית',
        es: 'Español',
        zh: '中文'
    };

    var otherLanguages = Object.keys(languageDictionary.displayNames).filter(x => x !== languageCode);

    var loginHint = config.extraParams.login_hint;
    var realOptions = {
        additionalSignUpFields: [
            {
                name: "first_name",
                placeholder: "  ",
                validator: function(first_name) {
                    return {
                        valid: first_name.length > 0,
                        hint: languageDictionary.firstNameHint
                    };
                }
            },
            {
                name: "last_name",
                placeholder: "   ",
                validator: function(last_name) {
                    return {
                        valid: last_name.length > 0,
                        hint: languageDictionary.lastNameHint
                    };
                }
            }
        ],
        avatar: null,
        autofocus: false,
        auth: {
            redirectUrl: config.callbackURL,
            responseType: (config.internalOptions || {}).response_type ||
            config.callbackOnLocationHash ? 'token' : 'code',
            params: config.internalOptions
        },
        assetsUrl:  config.assetsUrl,
        allowedConnections: connection ? [connection] : null,
        rememberLastLogin: false,
        language: languageCode === 'he' ? language : languageCode,
        languageDictionary: languageDictionary,
        theme: {
            logo:            headerLogo,
            primaryColor:    studyColor
        },
        prefill: loginHint ? { email: loginHint, username: loginHint } : null,
        closable: false,
        configurationBaseUrl: config.clientConfigurationBaseUrl,
        overrides: {
            __tenant: config.auth0Tenant,
            __token_issuer: mainUrl}
    };
    var options = {allowForgotPassword:true};
    if (mode === 'signup') {
        options.allowSignUp = true;
        options.allowLogin = false;
    }
    else if (mode === 'login') {
        options.allowSignUp = false;
        options.allowLogin = true;
    }
    else {
        options.allowSignUp = true;
        options.allowLogin = true;
    }
    if (config.extraParams.showPasswordReset) {
        options.allowSignUp = false;
        options.allowLogin = false;
    }
    if (config.extraParams.show_password_reset) {
        options.initialScreen = 'forgotPassword';
    }
    if (config.extraParams.user_email) {
        realOptions.prefill = {email: config.extraParams.user_email, username: config.extraParams.user_email};
    }
    if (config.extraParams.password_was_reset) {
        showPasswordRecentText = true;
    }
    var lock = new Auth0Lock(config.clientID, config.auth0Domain, realOptions);

    window.onclick = function(event) {
        if (!document.getElementsByClassName('language-dropdown')[0].contains(event.target)){
            closeDropdown()
        }
    };

    function closeDropdown() {
        let dropdowns = document.getElementsByClassName("dropdown-content");
        let i;
        for (i = 0; i < dropdowns.length; i++) {
            let openDropdown = dropdowns[i];
            if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
            }
        }
    }

    function switchLanguage(lang) {
        console.log('switching language to ' + JSON.stringify(lang));
        if (mode === 'login') {
            window.location.href = loginUrl.replace(languageCode, lang);
        }
        else {
            window.location.href =  registerUrl.replace(languageCode, lang);
        }
    }

    function showDropDown() {
        document.getElementById("langDropdown").classList.toggle("show");
    }

    function addHelp() {
        // we use setInterval because auth0's on() methods for display
        // do not account for all the display modes and they appear to fire
        // before animations complete, not after
        setInterval(function() {
            if (!document.getElementById('ddp-password-hint')) {
                //Add password prompt and hint
                var passwordHint = document.createElement('div');
                if (mode === 'signup'){
                    passwordHint.innerHTML = '<div id="ddp-password-hint"><label class="Input-label">' + languageDictionary.passwordPrompt + '</label>' +
                        '                    <i class="fa fa-question-circle Color--green tooltip" aria-hidden="true">' +
                        '<span class="tooltiptext">' + languageDictionary.passwordTooltipText + '</span></i></div>';
                }
                else {
                    passwordHint.innerHTML = '<div id="ddp-password-hint" class="TopPaddingTen"><label class="Input-label TopMargin10">' + languageDictionary.passwordPrompt + '</label></div>';
                }

                var passwordBlock = document.getElementsByClassName('auth0-lock-input-show-password')[0];
                if (passwordBlock) {
                    console.log('appending password hint');
                    passwordBlock.insertBefore(passwordHint, passwordBlock.childNodes[0]);
                }
            }
            if (!document.getElementById('auth0-lock-error-msg-password') && document.getElementsByClassName('auth0-lock-input-block auth0-lock-input-password auth0-lock-error')[0]) {
                //If the password is invalid but we haven't added the error message, set it
                var passwordError = document.getElementsByClassName('auth0-lock-input-block auth0-lock-input-password auth0-lock-error')[0];
                var errorText = languageDictionary.invalidErrorHint;

                // If the password field isn't empty but is invalid, make that the error message
                var inputElements = passwordError ? passwordError.getElementsByTagName('input') : null;
                var value = inputElements && inputElements[0] ? inputElements[0].value : null;
                if (value.length === 0) {
                    errorText = languageDictionary.blankErrorHint;
                }

                var passwordErrorMessage = document.createElement('div');
                passwordErrorMessage.innerHTML = `<span>${errorText}</span>`;
                passwordErrorMessage.setAttribute('role', 'alert');
                passwordErrorMessage.setAttribute('id', 'auth0-lock-error-msg-password');
                passwordErrorMessage.setAttribute('class', 'auth0-lock-error-msg');
                console.log('appending password error message');
                passwordError.appendChild(passwordErrorMessage);
            }
            if (document.getElementById('auth0-lock-error-msg-password') && !document.getElementsByClassName('auth0-lock-input-block auth0-lock-input-password auth0-lock-error')[0]){
                //If we're still showing the error message for the password field even though the field is now valid, get rid of the error message
                var errorMsg = document.getElementById('auth0-lock-error-msg-password');
                errorMsg.parentElement.removeChild(errorMsg);
            }
            if (!document.getElementById('ddp-email-prompt')) {
                // If we are logging in, add some instructions
                if (mode === 'login' && !document.getElementsByClassName('auth0-lock-back-button')[0]) {
                    var loginInstructions = document.createElement('div');
                    loginInstructions.innerHTML = '<div id="ddp-login-instructions"><h2 class="loginHeader">' + languageDictionary.loginLabel + '</h2> <h5 class="loginText">' + languageDictionary.loginDescriptionText + '</h5></div>';
                    var beforeBlock = document.getElementsByClassName('auth0-lock-input-email')[0];
                    if (beforeBlock) {
                        console.log('appending login instructions');
                        beforeBlock.parentElement.insertBefore(loginInstructions, beforeBlock);
                    }
                }

                //Add email prompt
                var emailPrompt = document.createElement('div');
                emailPrompt.innerHTML = '<div id="ddp-email-prompt"><label class="Input-label">' + languageDictionary.emailPrompt + '</label></div>';
                var emailBlock = document.getElementsByClassName('auth0-lock-input-email')[0];
                if (emailBlock) {
                    console.log('appending email prompt');
                    emailBlock.insertBefore(emailPrompt, emailBlock.childNodes[0]);
                }
            }
            if (!document.getElementById('ddp-first-name-prompt')) {
                //Add first name prompt
                var firstNamePrompt = document.createElement('div');
                firstNamePrompt.innerHTML = '<div id="ddp-first-name-prompt"><label class="Input-label NoTopMargin">' + languageDictionary.firstNamePrompt + '</label></div>';
                var firstNameBlock = document.getElementsByClassName('auth0-lock-input-first_name')[0];
                if (firstNameBlock) {
                    console.log('appending first name prompt');
                    firstNameBlock.insertBefore(firstNamePrompt, firstNameBlock.childNodes[0]);
                }
            }
            if (!document.getElementById('ddp-last-name-prompt')) {
                //Add last name prompt
                var lastNamePrompt = document.createElement('div');
                lastNamePrompt.innerHTML = '<div id="ddp-last-name-prompt"><label class="Input-label">' + languageDictionary.lastNamePrompt + '</label></div>';
                var lastNameBlock = document.getElementsByClassName('auth0-lock-input-last_name')[0];
                if (lastNameBlock) {
                    console.log('appending last name prompt');
                    lastNameBlock.insertBefore(lastNamePrompt, lastNameBlock.childNodes[0]);
                }
            }
            if (!document.getElementById('ddp-moved') && mode === 'signup' && document.getElementById('ddp-email-prompt') &&
                document.getElementById('ddp-first-name-prompt') &&
                document.getElementById('ddp-last-name-prompt') && document.getElementById('ddp-password-hint') &&
                document.getElementsByClassName('auth0-lock-input-email') &&
                document.getElementsByClassName('auth0-lock-input-email')[0]) {

                console.log('reordering elements');

                //Reorder elements to make first name and last name come before email address and password
                //Get the email address block
                var emailAddressBlock = document.getElementsByClassName('auth0-lock-input-email')[0];

                //Get the parent of the email address block
                var parentBlock = emailAddressBlock.parentElement;

                //Move the first name block before the email address block
                firstNameBlock = document.getElementsByClassName('auth0-lock-input-first_name')[0];
                parentBlock.insertBefore(firstNameBlock, emailAddressBlock);

                //Move the last name block before the email address block
                lastNameBlock = document.getElementsByClassName('auth0-lock-input-last_name')[0];
                parentBlock.insertBefore(lastNameBlock, emailAddressBlock);

                //Add an element to the bottom to indicate that we changed the order
                var moved = document.createElement('div');
                moved.setAttribute('id', 'ddp-moved');
                document.lastChild.appendChild(moved);
            }
            if (!document.getElementById('ddp-set-focus') && mode === 'signup') {
                var toFocus = document.getElementsByClassName('auth0-lock-input')[0];
                if (toFocus) {
                    console.log('focusing');
                    toFocus.focus();
                    var focused = document.createElement('div');
                    focused.setAttribute('id', 'ddp-set-focus');
                    document.lastChild.appendChild(focused);
                    toFocus.focus();
                }
            }
            if (!document.getElementById('ddp-header')) {
                // tweak the header
                var signInClass = 'Nav-itemLink';
                var joinUsClass = 'Button Button--secondaryWhite';

                if (mode === 'signup') {
                    joinUsClass = 'Button Button--active';
                }
                if (mode === 'login' && !document.getElementsByClassName('auth0-lock-back-button')[0]) {
                    signInClass = 'Nav-itemLink Nav-itemLink--active';
                }

                var globeSVG = '<svg class="ddp-globe" width="24px" height="24px" viewBox="0 0 24 24" aria-live="title" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">' +
                    '  <title>' + languageDictionary.languageSelection + '</title>' +
                    '    <g id="Language-Selector-3" transform="translate(-1243.000000, -20.000000)">' +
                    '      <g id="nav-bar" transform="translate(1.000000, 0.000000)">' +
                    '        <g id="Globe" transform="translate(1243.000000, 21.000000)">' +
                    '          <g id="earth-3">' +
                    '            <g stroke-width="1.5">' +
                    '              <circle id="Oval" cx="11" cy="11" r="10.3125"></circle>' +
                    '              <path d="M8.51491667,21.0109167 C7.11975,18.9649167 6.1875,15.2469167 6.1875,11 C6.1875,6.75308333 7.11975,3.03508333 8.51491667,0.989083333" id="Shape"></path>' +
                    '              <path d="M0.6875,11 L21.3125,11" id="Shape"></path>' +
                    '              <path d="M2.27516667,16.5 L19.7248333,16.5" id="Shape"></path>' +
                    '              <path d="M2.27516667,5.5 L19.7248333,5.5" id="Shape"></path>' +
                    '              <path d="M13.4850833,0.989083333 C14.88025,3.03508333 15.8125,6.75308333 15.8125,11 C15.8125,15.2469167 14.88025,18.9649167 13.4850833,21.0109167" id="Shape"></path>' +
                    '            </g>' +
                    '          </g>' +
                    '        </g>' +
                    '      </g>' +
                    '    </g>' +
                    '</svg>';

                var languageSelector =
                    '<li class="Nav-item">' +
                    '<div [hidden]="!loaded" class=" language-dropdown Nav-itemLink">' +
                    '<button class="SimpleButton dropdown-button" onclick="showDropDown()"> ' + globeSVG +
                    ' <span class="ddp-current-language">' + languageDictionary.displayNames[languageCode] + '</span> ' +
                    '<i class="material-icons ddp-dropdown-arrow">arrow_drop_down</i> ' +
                    '</button>' +
                    '<div id="langDropdown" class="dropdown-content">' +
                    '<button class="language-menu-item" onclick="switchLanguage(otherLanguages[0])">' + languageDictionary.displayNames[otherLanguages[0]] + '</button>' +
                    '<button class="language-menu-item" onclick="switchLanguage(otherLanguages[1])">' + languageDictionary.displayNames[otherLanguages[1]] + '</button>' +
                    '<button class="language-menu-item" onclick="switchLanguage(otherLanguages[2])">' + languageDictionary.displayNames[otherLanguages[2]] + '</button>' +
                    '</div>' +
                    '</div>' +
                    '</li>';

                var header = document.createElement('div');
                header.innerHTML=`<header class="Header" id="ddp-header"><a id="top"/><nav class="navbar navbar-default Header-background">` +
                    `<div class="navbar-header">` +
                    `<button type="button" class="navbar-toggle collapsed Header-hamburger" data-toggle="collapse" ` +
                    `data-target="#menu" aria-expanded="false">` +
                    `<span class="sr-only"></span>` +
                    `<span class="icon-bar"></span>` +
                    `<span class="icon-bar"></span>` +
                    `<span class="icon-bar"></span>` +
                    `</button>` +
                    `<a class="Header-logo" href="${mainUrl}">` +
                    `<img src="${headerLogo}" alt="${languageDictionary.logoAlt}"></a>` +
                    `</div>` +
                    `<div class="collapse navbar-collapse Header-collapse" id="menu">` +
                    `<ul class="nav navbar-nav navbar-right NoMargin">${languageSelector}` +
                    `<li class="Nav-item"><a href="${mainUrl}/learn-more" class="Nav-itemLink">` +
                    `${languageDictionary.learnMore}</a></li>` +
                    `<li class="Nav-item"><a href="${mainUrl}/study-listing" class="Nav-itemLink">${languageDictionary.studyListing}</a></li>` +
                    `<li class="Nav-item"><a href="${loginUrl}" class="${signInClass}" id="SignIn">` +
                    `${languageDictionary.signIn}</a></li>` +
                    `<li class="Nav-item Nav-item-JoinUs">` +
                    `<a class="${joinUsClass}" href="${registerUrl}" id="JoinUs">${languageDictionary.joinUs}</a>` +
                    `</li>` +
                    `</ul>` +
                    `</div>` +
                    `</nav></header>`;

                var auth0LockHeader = document.getElementsByClassName('auth0-lock-header-logo')[0];
                if (auth0LockHeader) {
                    console.log('appending header');
                    auth0LockHeader.parentElement.removeChild(auth0LockHeader);
                    var headerWelcome = document.getElementsByClassName('auth0-lock-header-welcome')[0];
                    headerWelcome.insertBefore(header,(headerWelcome.hasChildNodes())
                        ? headerWelcome.childNodes[0]
                        : null);
                }
            }
            else if (mode === 'login' && document.getElementsByClassName('auth0-lock-back-button')[0] && document.getElementsByClassName('Nav-itemLink--active')[0]) {
                console.log('marking link inactive');
                var signInElem = document.getElementsByClassName('Nav-itemLink--active')[0];
                signInElem.setAttribute('class', 'Nav-itemLink');
            }
            else if (mode === 'login' && !document.getElementsByClassName('auth0-lock-back-button')[0] && !document.getElementsByClassName('Nav-itemLink--active')[0]) {
                console.log('marking link active');
                signInElem = document.getElementById('SignIn');
                signInElem.setAttribute('class', 'Nav-itemLink Nav-itemLink--active');
            }
            if (!document.getElementById('ddp-footer') && document.getElementById('ddp-middle-container')) {
                var footer = document.createElement('div');
                footer.setAttribute('id', 'ddp-footer');
                footer.innerHTML =
                `<footer class="Footer row">` +
                    `<div class="col-lg-6 col-md-4 col-sm-4 col-xs-12 Footer-left">` +
                        `<a href="${mainUrl}">` +
                        `<img src="https://storage.googleapis.com/dev-prion-assets/images/project-logo-dark.svg" alt="${languageDictionary.logoAlt}"/>` +
                        `</a>` +
                        `<p class="Footer-contact">${languageDictionary.contactUs}` +
                            `<a href="mailto:${contactEmail}" class="Footer-link NoPadding">${contactEmail}</a>` +
                        `</p>` +
                    `</div>` +
                    `<div class="col-lg-6 col-md-4 col-sm-8 col-xs-12 Footer-links">` +
                        `<p class="Footer-text Float--right">` +
                            `<a href="${mainUrl}" class="Footer-link">${languageDictionary.home}</a> ` +
                            `<a href="${mainUrl}/learn-more" class="Footer-link">${languageDictionary.learnMore}</a> ` +
                            `<a href="${registerUrl}" class="Footer-link">${languageDictionary.joinUs}</a> ` +
                            `<a href="${loginUrl}?destParamValue=login" class="Footer-link">${languageDictionary.signIn}</a> ` +
                            `<a href="${mainUrl}/privacy-policy" class="Footer-link">${languageDictionary.privacyPolicy}</a> ` +
                            `<a href="#top" class="Footer-link backToTopLink">` +
                                `<i class="fas fa-arrow-up Footer-arrow"></i>` +
                                `<span class="backToTopText">${languageDictionary.backToTop}</span>` +
                            `</a>` +
                        `</p>` +
                    `</div>` +
                `</footer>`;

                var parBlock = document.getElementById('ddp-middle-container').parentElement;

                if (parBlock) {
                    console.log('appending footer');
                    parBlock.appendChild(footer);
                }
            }
            if (!document.getElementById('ddp-middle-container') && document.getElementsByClassName('auth0-lock-form')[0] &&
                !document.getElementsByClassName('auth0-loading-screen')[0] && document.getElementById('ddp-help')) {
                var middleContainer = document.createElement('div');
                middleContainer.setAttribute('id', 'ddp-middle-container');
                middleContainer.setAttribute('class', 'MiddleContainer');

                var button = document.getElementsByClassName('auth0-lock-submit')[0];
                var mainSection = button.previousSibling;
                var formSection = document.getElementsByClassName('auth0-lock-form')[0];

                if (mainSection && button && formSection) {
                    console.log('Moving elements into middle container');

                    //Put the middle container into the document
                    button.parentElement.insertBefore(middleContainer, button);

                    //Put the main section in the new middle container
                    middleContainer.appendChild(mainSection);

                    //Put the button in the middle container
                    middleContainer.appendChild(button);
                }
            }

            if (!document.getElementById('ddp-help') && document.getElementsByClassName('auth0-lock-form')[0] &&
                !document.getElementsByClassName('auth0-loading-screen')[0]) {
                var lockForm = document.getElementsByClassName('auth0-lock-form');

                var showSignUpHelp = document.getElementsByClassName('auth0-lock-last-login-pane').length === 0;
                if (mode === 'login' && !doNotShowRegLink) {
                    // navigate back to registration
                    var registerMessageWrapper = document.createElement("p");
                    registerMessageWrapper.setAttribute('class','auth0-lock-alternative');
                    registerMessageWrapper.setAttribute('id','ddp-reg');
                    registerMessageWrapper.setAttribute('style','margin-top:0;font-size: small;text-align: left;');
                    if (showSignUpHelp) {
                        var registerMessage = document.createElement('p');
                        registerMessage.setAttribute('style','margin-top:0;margin-bottom:5px');
                        registerMessage.innerHTML =  "<a class='auth0-lock-alternative-link' href='" + registerUrl + "'>" + languageDictionary.registerMessageText + "</a>.";
                        registerMessageWrapper.appendChild(registerMessage);
                        if (lockForm) {
                            console.log('appending register message');
                            lockForm[0].appendChild(registerMessageWrapper);
                        }
                    }
                }
                var helpWrapper = document.createElement('div');
                helpWrapper.setAttribute('id','ddp-help');
                helpWrapper.setAttribute('style','display:flex;flex-direction:row;align-items:center;margin-top:5px;flex-wrap:none;');
                if (lockForm) {
                    console.log('appending help wrapper');
                    lockForm[0].appendChild(helpWrapper);
                }
                if (mode === 'signup' || options.allowSignUp) {
                    console.log('appending sign in here to help wrapper');
                    var loginLink = document.createElement('a');
                    loginLink.setAttribute('class', 'auth0-lock-alternative-link');
                    loginLink.setAttribute('href', loginUrl);
                    loginLink.innerText = languageDictionary.alreadyRegisteredText;
                    var switchToLogin = document.createElement('p');
                    switchToLogin.setAttribute('style','text-align:left;margin-top:15px;margin-bottom:5px');
                    switchToLogin.innerText = '';
                    switchToLogin.appendChild(loginLink);
                    helpWrapper.parentElement.appendChild(switchToLogin);
                }
                if (showPasswordRecentText) {
                    if (!document.getElementById('ddp-pwd')) {
                        console.log('prepending reset password wrapper');
                        var resetPasswordWrapper = document.createElement("p");
                        resetPasswordWrapper.setAttribute('class','auth0-lock-alternative');
                        resetPasswordWrapper.setAttribute('id','ddp-pwd');
                        resetPasswordWrapper.setAttribute('style','margin-top:0px;');
                        var resetPasswordText = document.createElement("div");
                        resetPasswordText.innerText = languageDictionary.passwordResetSuccessMessage;
                        resetPasswordWrapper.appendChild(resetPasswordText);
                        document.getElementsByClassName('auth0-lock-content')[0].prepend(resetPasswordWrapper);
                    }
                }
            }
        },200);
    }
    lock.on('show',function() {
        addHelp();
        var getInputElement = function(name) {
            return document.getElementsByName(name)[0];
        };
        var setFocus = function(theElement) {
            theElement.focus();
            return true;
        };
        var getElementWithFocus = function() {
            return document.querySelector(':focus');
        };
        var intervalId = setInterval(function() {
            var firstNameElement = getInputElement('first_name');
            if(firstNameElement){
                setFocus(firstNameElement);
                var elementWithFocus = getElementWithFocus();
                if(elementWithFocus && elementWithFocus.name && firstNameElement.name === elementWithFocus.name){
                    clearInterval(intervalId);
                }
            }
        }, 200);
    });
    lock.on('forgot_password ready', function() {
    });
    console.log('auth mode: ' + mode);
    lock.show(options);
</script>
</body>
</html>
