{
  "workflowTransitions": [
    # invited patient workflow
    {
      "from": {
        "type": "START"
      },
      "to": [
        {
          "type": "ACTIVITY",
          "activityCode": ${id.act.consent},
          "expression": """user.studies["testboston"].hasInvitation("RECRUITMENT")"""
        }
      ]
    },
    {
      "from": {
        "type": "ACTIVITY",
        "activityCode": ${id.act.consent}
      },
      "to": [
        {
          "type": "ACTIVITY",
          "activityCode": ${id.act.covid_survey},
          "expression": """user.studies["testboston"].forms["CONSENT"].isStatus("COMPLETE")"""
        }
      ]
    },
    {
      "from": {
        "type": "ACTIVITY",
        "activityCode": ${id.act.covid_survey}
      },
      "to": [
        {
          "type": "ACTIVITY",
          "activityCode": ${id.act.address},
          "expression": """user.studies["testboston"].forms["COVID_SURVEY"].isStatus("COMPLETE")"""
        }
      ]
    },
    {
      "from": {
        "type": "ACTIVITY",
        "activityCode": ${id.act.address}
      },
      "to": [
        {
          "type": "DASHBOARD",
          "expression": "true"
        }
      ]
    },

    # return user workflow
    {
      "from": {
        "type": "RETURN_USER"
      },
      "to": [
        {
          "type": "ACTIVITY",
          "activityCode": ${id.act.address},
          "expression": """
            user.studies["testboston"].forms["ADDRESS"].hasInstance()
            && user.studies["testboston"].forms["ADDRESS"].isStatus("CREATED", "IN_PROGRESS")
          """
        },
        {
          "type": "ACTIVITY",
          "activityCode": ${id.act.covid_survey},
          "expression": """
            user.studies["testboston"].forms["COVID_SURVEY"].hasInstance()
            && user.studies["testboston"].forms["COVID_SURVEY"].isStatus("CREATED", "IN_PROGRESS")
          """
        },
        {
          "type": "ACTIVITY",
          "activityCode": ${id.act.consent},
          "expression": """
            user.studies["testboston"].forms["CONSENT"].hasInstance()
            && user.studies["testboston"].forms["CONSENT"].isStatus("CREATED", "IN_PROGRESS")
          """
        },
        {
          "type": "DASHBOARD",
          "expression": "true"
        }
      ]
    }
  ]
}
