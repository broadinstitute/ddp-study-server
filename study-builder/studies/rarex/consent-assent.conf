{
  include required("../snippets/activity-general-form.conf"),
  "formType": "CONSENT",
  "studyGuid": "RAREX",
  "activityCode": "CONSENT_ASSENT",
  "versionTag": "v1",
  "displayOrder": 1,
  "writeOnce": true,
  "maxInstancesPerUser": 1,
  "translatedNames": [
    {
      "language": "en",
      "text": "Consent & Assent Form"
    }
  ],
  "translatedTitles": [
    {
      "language": "en",
      "text": "Consent & Assent Form"
    }
  ],
  "translatedSubtitles": [
    {
      "language": "en",
      "text": """<p class="no-margin sticky__text"><span>If you have questions about the study or the consent form at any time, please contact us at </span>
        <a href="tel:(716) 427-2739" class="Link">(716) 427-2739</a> or
        <a href="mailto:support@rare-x.org" class="Link">support@rare-x.org</a>.</p>"""
    }
  ],
  "translatedSummaries": [
    {
      "statusCode": "CREATED",
      "language": "en",
      "text": """Please sign the research consent form, which will allow us to obtain a saliva sample, copies of your child's medical records,
        and opt-in to share your child's blood samples and/or archived tumor tissue."""
    },
    {
      "statusCode": "IN_PROGRESS",
      "language": "en",
      "text": """Please sign the research consent form, which will allow us to obtain a saliva sample, copies of your child's medical records,
        and opt-in to share your child's blood samples and/or archived tumor tissue."""
    },
    {
      "statusCode": "COMPLETE",
      "language": "en",
      "text": "Thank you for signing the research consent form."
    }
  ],
  "readonlyHintTemplate": {
    "templateType": "HTML",
    "templateText": "$rarex_consent_assent_readonly_hint",
    "variables": [
      {
        "name": "rarex_consent_assent_readonly_hint",
        "translations": [
          {
            "language": "en",
            "text": """<p class="no-margin">
              Thank you for signing the consent form. If you would like to make any changes, please reach out to the study team
              at <a href="mailto:support@rare-x.org" class="Link">support@rare-x.org</a>, or call us
              at <a href="tel:(716) 427-2739" class="Link">(716) 427-2739</a>.
              </p>"""
          }
        ]
      }
    ]
  },
  "consentedExpr": """
    user.studies["rarex"].forms["CONSENT_ASSENT"].questions["CONSENT_ASSENT_CHILD_DOB"].answers.hasDate()
    && user.studies["rarex"].forms["CONSENT_ASSENT"].questions["CONSENT_ASSENT_PARENT_SIGNATURE"].answers.hasText()
    && user.studies["rarex"].forms["CONSENT_ASSENT"].questions["CONSENT_ASSENT_CHILD_SIGNATURE"].answers.hasText()
  """,
  "elections": [
    {
      "stableId": "CONSENT_ASSENT_AGREE_FOLLOW_UP",
      "selectedExpr": """user.studies["rarex"].forms["CONSENT_ASSENT"].questions["CONSENT_ASSENT_AGREE_FOLLOW_UP"].answers.hasTrue()"""
    },
    {
      "stableId": "CONSENT_ASSENT_AGREE_CONTACT_RESULT",
      "selectedExpr": """user.studies["rarex"].forms["CONSENT_ASSENT"].questions["CONSENT_ASSENT_AGREE_CONTACT_RESULT"].answers.hasTrue()"""
    }
  ],
  "introduction": { include required("snippets/consent-intro.conf") },
  "sections": [
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "1. Summary of Research Program",
        "variables": []
      },
      "icons": [],
      "blocks": [
        { include required("snippets/consent-section1-preamble.conf") },
      ]
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "2. Full Form - 1",
        "variables": []
      },
      "icons": [],
      "blocks": [
        { include required("snippets/consent-section2-intro.conf") },
        { include required("snippets/consent-section2-purpose.conf") }
      ],
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "2. Full Form - 2",
        "variables": []
      },
      "icons": [],
      "blocks": [
        { include required("snippets/consent-section2-funding.conf") },
        { include required("snippets/consent-section2-timing.conf") },
        { include required("snippets/consent-section2-eligible.conf") },
        { include required("snippets/consent-section2-whatsnext.conf") }
      ]
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "2. Full Form - 3",
        "variables": []
      },
      "icons": [],
      "blocks": [
        { include required("snippets/consent-section2-info.conf") },
        { include required("snippets/consent-section2-limit.conf") },
        { include required("snippets/consent-section2-access.conf") }
      ]
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "2. Full Form - 4",
        "variables": []
      },
      "icons": [],
      "blocks": [
        { include required("snippets/consent-section2-choises.conf") },
      ]
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "2. Full Form - 5",
        "variables": []
      },
      "icons": [],
      "blocks": [
        { include required("snippets/consent-section2-clinicaltrial.conf") },
        { include required("snippets/consent-section2-benefits.conf") },
        { include required("snippets/consent-section2-confidentiality.conf") },
        { include required("snippets/consent-section2-risks.conf") },
        { include required("snippets/consent-section2-cost.conf") },
        { include required("snippets/consent-section2-voluntary.conf") },
      ]
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "2. Full Form - 6",
        "variables": []
      },
      "icons": [],
      "blocks": [
        { include required("snippets/consent-section2-withdraw.conf") },
        { include required("snippets/consent-section2-contact.conf") }
      ]
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "3. Sign Consent",
        "variables": []
      },
      "icons": [],
      "blocks": [
        {
          "titleTemplate": null,
          "bodyTemplate": {
            "templateType": "HTML",
            "templateText": """<h3 class="underline">$rarex_consent_assent_s3_preamble</h3>""",
            "variables": [
              {
                "name": "rarex_consent_assent_s3_preamble",
                "translations": [
                  {
                    "language": "en",
                    "text": "Consent Documentation"
                  }
                ]
              }
            ]
          },
          "blockType": "CONTENT",
          "shownExpr": null
        },
        { include required("snippets/consent-section3-terms.conf") },
        {
          "titleTemplate": null,
          "bodyTemplate": {
            "templateType": "HTML",
            "templateText": """<p class="consent-agree bold">$rarex_consent_s3_questions_agree</p>""",
            "variables": [
              {
                "name": "rarex_consent_s3_questions_agree",
                "translations": [
                  {
                    "language": "en",
                    "text": """Check the boxes below to indicate if you agree to the following options. <i>If you check “no” to any
                      given option, you can still take part in this Program.</i>"""
                  }
                ]
              }
            ]
          },
          "blockType": "CONTENT",
          "shownExpr": null
        },
        {
          "question": {
            include required("../snippets/bool-question-yes-no-required.conf"),
            "stableId": "CONSENT_ASSENT_AGREE_FOLLOW_UP",
            "hideNumber": true,
            "promptTemplate": {
              "templateType": "HTML",
              "templateText": "$CONSENT_ASSENT_AGREE_FOLLOW_UP_TEXT",
              "variables": [
                {
                  "name": "CONSENT_ASSENT_AGREE_FOLLOW_UP_TEXT",
                  "translations": [
                    {
                      "language": "en",
                      "text": "RARE-X may contact me with follow-up research questionnaires and invitations to participate in additional studies. I may choose to ignore these questionnaires/invitations."
                    }
                  ]
                }
              ]
            }
          },
          "blockType": "QUESTION",
          "shownExpr": null
        },
        {
          "question": {
            include required("../snippets/bool-question-yes-no-required.conf"),
            "stableId": "CONSENT_ASSENT_AGREE_CONTACT_RESULT",
            "hideNumber": true,
            "promptTemplate": {
              "templateType": "HTML",
              "templateText": "$CONSENT_ASSENT_AGREE_CONTACT_RESULT_TEXT",
              "variables": [
                {
                  "name": "CONSENT_ASSENT_AGREE_CONTACT_RESULT_TEXT",
                  "translations": [
                    {
                      "language": "en",
                      "text": "RARE-X or a patient organization that I choose may contact me in the event that it becomes possible to return test results to me."
                    }
                  ]
                }
              ]
            }
          },
          "blockType": "QUESTION",
          "shownExpr": null
        }
        { include required("snippets/consent-section3-additional-terms.conf") },
        {
          "question": {
            include required("snippets/text-question-child-firstname.conf"),
            "stableId": "CONSENT_ASSENT_CHILD_FIRSTNAME"
          },
          "blockType": "QUESTION",
          "shownExpr": null
        },
        {
          "question": {
            include required("snippets/text-question-child-lastname.conf"),
            "stableId": "CONSENT_ASSENT_CHILD_LASTNAME"
          },
          "blockType": "QUESTION",
          "shownExpr": null
        },
        {
          "question": {
            include required("snippets/date-question-child-dob.conf"),
            "stableId": "CONSENT_ASSENT_CHILD_DOB"
          },
          "blockType": "QUESTION",
          "shownExpr": null
        },
        {
          "titleTemplate": null,
          "bodyTemplate": {
            "templateType": "HTML",
            "templateText": """
              <div class="subject">
                <div class="subject__block">
                  <h4 class="static-text">$consent_name_template</h4>
                </div>
                <div class="subject__block">
                  <p class="static-header">$consent_first_name</p>
                  <p class="static-text">$ddp.participantFirstName()</p>
                </div>
                <div class="subject__block">
                  <p class="static-header">$consent_last_name</p>
                  <p class="static-text">$ddp.participantLastName()</p>
                </div>
              </div>
            """,
            "variables": [
              {
                "name": "consent_name_template",
                "translations": [
                  { "language": "en", "text": ${i18n.en.consent_name_template} }
                ]
              },
              {
                "name": "consent_first_name",
                "translations": [
                  { "language": "en", "text": ${i18n.en.consent_first_name} }
                ]
              },
              {
                "name": "consent_last_name",
                "translations": [
                  { "language": "en", "text": ${i18n.en.consent_last_name} }
                ]
              }
            ]
          },
          "blockType": "CONTENT",
        },
        {
          "question": {
            include required("snippets/text-question-parental-signature.conf"),
            "stableId": "CONSENT_ASSENT_PARENT_SIGNATURE"
          },
          "blockType": "QUESTION",
          "shownExpr": null
        }//,
//        {
//          "question": {
//            include required("snippets/picklist-question-relationship.conf"),
//            "stableId": "CONSENT_ASSENT_RELATIONSHIP"
//          },
//          "blockType": "QUESTION",
//          "shownExpr": null
//        }
      ]
    },
    {
      "nameTemplate": {
        "templateType": "TEXT",
        "templateText": "4. Assent",
        "variables": []
      },
      "icons": [],
      "blocks": [
        {
          "question": {
            include required( "../snippets/picklist-question-single-list.conf"),
            "stableId": "ASSENT_ABLE_READ",
            "hideNumber": true,
            "promptTemplate": {
              "templateType": "HTML",
              "templateText": "$assent_able_read_q",
              "variables": [
                {
                  "name": "assent_able_read_q",
                  "translations": [
                    {
                      "language": "en",
                      "text": "Is your child able to read a simple form about their participation?"
                    }
                  ]
                }
              ]
            },
            "picklistOptions": [
              {
                "stableId": "YES",
                "optionLabelTemplate": {
                  "templateType": "TEXT",
                  "templateText": "$assent_able_read_yes_text",
                  "variables": [
                    {
                      "name": "assent_able_read_yes_text",
                      "translations": [
                        {
                          "language": "en",
                          "text": "Yes, my child can read"
                        }
                      ]
                    }
                  ]
                },
                "detailLabelTemplate": null,
                "allowDetails": false,
                "exclusive": false
              },
              {
                "stableId": "NO",
                "optionLabelTemplate": {
                  "templateType": "TEXT",
                  "templateText": "$assent_able_read_no_text",
                  "variables": [
                    {
                      "name": "assent_able_read_no_text",
                      "translations": [
                        {
                          "language": "en",
                          "text": "No, my child cannot read"
                        }
                      ]
                    }
                  ]
                },
                "detailLabelTemplate": null,
                "allowDetails": false,
                "exclusive": false
              }
            ],
            "validations": [
              {
                "ruleType": "REQUIRED",
                "hintTemplate": {
                  "templateType": "TEXT",
                  "templateText": "$assent_able_read_req_hint",
                  "variables": [
                    {
                      "name": "assent_able_read_req_hint",
                      "translations": [
                        {
                          "language": "en",
                          "text": "Please choose one of the above options."
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          },
          "blockType": "QUESTION",
          "shownExpr": null
        },
        { include required("snippets/consent-assent-unable-to-consent-title.conf") },
        {
          "titleTemplate": null,
          "bodyTemplate": {
            "templateType": "HTML",
            "templateText": """<h4>$rarex_consent_assent_s4_able_read</h4>""",
            "variables": [
              {
                "name": "rarex_consent_assent_s4_able_read",
                "translations": [
                  {
                    "language": "en",
                    "text": "Patient able to read assent:"
                  }
                ]
              }
            ]
          },
          "blockType": "CONTENT",
          "shownExpr": """user.studies["rarex"].forms["CONSENT_ASSENT"].questions["ASSENT_ABLE_READ"].answers.hasOption("ASSENT_ABLE_READ_YES")"""
        },
        { include required("snippets/consent-assent-section4-self-read.conf") },
        {
          "titleTemplate": null,
          "bodyTemplate": {
            "templateType": "HTML",
            "templateText": "<h4>$rarex_consent_assent_s4_instructions_heading</h4>",
            "variables": [
              {
                "name": "rarex_consent_assent_s4_instructions_heading",
                "translations": [
                  {
                    "language": "en",
                    "text": "Instructions for Parents/Guardians and other Legally Authorized Representatives"
                  }
                ]
              }
            ]
          },
          "blockType": "CONTENT",
          "shownExpr": """user.studies["rarex"].forms["CONSENT_ASSENT"].questions["ASSENT_ABLE_READ"].answers.hasOption("ASSENT_ABLE_READ_NO")"""
        },
        { include required("snippets/consent-assent-section4-child-instruction.conf") },
        {
          "titleTemplate": null,
          "bodyTemplate": {
            "templateType": "HTML",
            "templateText": """<h4>$rarex_consent_assent_s4_read</h4>""",
            "variables": [
              {
                "name": "rarex_consent_assent_s4_read",
                "translations": [
                  {
                    "language": "en",
                    "text": "Script to Read to Your Child"
                  }
                ]
              }
            ]
          },
          "blockType": "CONTENT",
          "shownExpr": """user.studies["rarex"].forms["CONSENT_ASSENT"].questions["ASSENT_ABLE_READ"].answers.hasOption("ASSENT_ABLE_READ_NO")"""
        },
        { include required("snippets/consent-assent-section4-child-intro.conf") },
        {
          "question": {
            include required("../snippets/text-question-signature-required.conf"),
            "stableId": "CONSENT_ASSENT_CHILD_SIGNATURE",
            "isRestricted": true,
            "hideNumber": true,
            "promptTemplate": {
              "templateType": "HTML",
              "templateText": "$prompt_CONSENT_ASSENT_CHILD_SIGNATURE",
              "variables": [
                {
                  "name": "prompt_CONSENT_ASSENT_CHILD_SIGNATURE",
                  "translations": [
                    {
                      "language": "en",
                      "text": "Child/Adolescent Assent"
                    }
                  ]
                }
              ]
            },
            "placeholderTemplate": {
              "templateType": "TEXT",
              "templateText": "$CONSENT_ASSENT_CHILD_SIGNATURE_placeholder",
              "variables": [
                {
                  "name": "CONSENT_ASSENT_CHILD_SIGNATURE_placeholder",
                  "translations": [
                    {
                      "language": "en",
                      "text": "Full Name"
                    }
                  ]
                }
              ]
            }
          },
          "blockType": "QUESTION",
          "shownExpr": """user.studies["rarex"].forms["CONSENT_ASSENT"].questions["ASSENT_ABLE_READ"].isAnswered()"""
        }
      ]
    }
  ]
}
