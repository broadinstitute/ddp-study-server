{
  include required("../snippets/activity-general-form.conf"),
  "studyGuid": ${id.study},
  "activityCode": ${id.act.prequal},
  "versionTag": "v1",
  "displayOrder": 1,
  "writeOnce": true,
  "maxInstancesPerUser": 1,
  "excludeFromDisplay": true,
  "allowUnauthenticated": true,
  "translatedNames": [
    {
      "language": "en",
      "text": ${i18n.en.prequal_translatedNames}
    },
    {
      "language": "es",
      "text": ${i18n.es.prequal_translatedNames}
    }
  ],
  "translatedTitles": [
    {
      "language": "en",
      "text": ${i18n.en.prequal_translatedTitles}
    },
    {
      "language": "es",
      "text": ${i18n.es.prequal_translatedTitles}
    }
  ],
  "translatedSubTitles": [
    {
      "language": "en",
      "text": ${i18n.en.prequal_translatedSubTitles}
    },
    {
      "language": "es",
      "text": ${i18n.es.prequal_translatedSubTitles}
    }
  ],
  "introduction": {
    "nameTemplate": null,
    "icons": [],
    "blocks": [
      {
        "listStyleHint": "BULLET",
        "title": {
          "templateType": "HTML",
          "templateText": """<h2 class="PageContent-subtitle Normal">$pancan_prequal_intro</h2>""",
          "variables": [
            {
              "name": "pancan_prequal_intro",
              "translations": [
                {
                  "language": "en",
                  "text": ${i18n.en.prequal_intro}
                },
                {
                  "language": "es",
                  "text": ${i18n.es.prequal_intro}
                }
              ]
            }
          ]
        },
        "nested": [
          {
            "titleTemplate": null,
            "bodyTemplate": {
              "templateType": "HTML",
              "templateText": """<p class="PageContent-text">$pancan_prequal_intro_01</p>""",
              "variables": [
                {
                  "name": "pancan_prequal_intro_01",
                  "translations": [
                    {
                      "language": "en",
                      "text": ${i18n.en.prequal_introduction_registration}
                    },
                    {
                      "language": "es",
                      "text": ${i18n.es.prequal_introduction_registration}
                    }
                  ]
                }
              ]
            },
            "blockType": "CONTENT",
            "shownExpr": null
          },
          {
            "titleTemplate": null,
            "bodyTemplate": {
              "templateType": "HTML",
              "templateText": """<p class="PageContent-text">$pancan_prequal_intro_02</p>""",
              "variables": [
                {
                  "name": "pancan_prequal_intro_02",
                  "translations": [
                    {
                      "language": "en",
                      "text": ${i18n.en.prequal_introduction_consentForm}
                    },
                    {
                      "language": "es",
                      "text": ${i18n.es.prequal_introduction_consentForm}
                    }
                  ]
                }
              ]
            },
            "blockType": "CONTENT",
            "shownExpr": null
          },
          {
            "titleTemplate": null,
            "bodyTemplate": {
              "templateType": "HTML",
              "templateText": """<p class="PageContent-text">$pancan_prequal_intro_03</p>""",
              "variables": [
                {
                  "name": "pancan_prequal_intro_03",
                  "translations": [
                    {
                      "language": "en",
                      "text": ${i18n.en.prequal_introduction_medicalReleaseForm}
                    },
                    {
                      "language": "es",
                      "text": ${i18n.es.prequal_introduction_medicalReleaseForm}
                    }
                  ]
                }
              ]
            },
            "blockType": "CONTENT",
            "shownExpr": null
          },
          {
            "titleTemplate": null,
            "bodyTemplate": {
              "templateType": "HTML",
              "templateText": """<p class="PageContent-text">$pancan_prequal_intro_04</p>""",
              "variables": [
                {
                  "name": "pancan_prequal_intro_04",
                  "translations": [
                    {
                      "language": "en",
                      "text": ${i18n.en.prequal_introduction_surveyAnswers}
                    },
                    {
                      "language": "es",
                      "text": ${i18n.es.prequal_introduction_surveyAnswers}
                    }
                  ]
                }
              ]
            },
            "blockType": "CONTENT",
            "shownExpr": null
          }
        ],
        "blockType": "GROUP",
        "shownExpr": null
      },
    ]
  },
  "sections": [
    {
      "nameTemplate": null,
      "icons": [],
      "blocks": [
        {
          "listStyleHint": "NONE",
          "title": {
            "templateType": "HTML",
            "templateText": """<h1 class="PageContent-title">$pancan_prequal_section01_title</h1>""",
            "variables": [
              {
                "name": "pancan_prequal_section01_title",
                "translations": [
                  {
                    "language": "en",
                    "text": ${i18n.en.prequal_introduction_titleWho}
                  },
                  {
                    "language": "es",
                    "text": ${i18n.es.prequal_introduction_titleWho}
                  }
                ]
              },
              {
                "name": "pancan_prequal_section01_subtitle",
                "translations": [
                  {
                    "language": "en",
                    "text": ${i18n.en.prequal_Check_that_apply}
                  },
                  {
                    "language": "es",
                    "text": ${i18n.es.prequal_Check_that_apply}
                  }
                ]
              }
            ]
          },
          "nested": [
            {
              "question": {include required("../snippets/picklist-question-single-list.conf")} {
                "stableId": "PREQUAL_SELF_DESCRIBE",
                "hideNumber": true,
                "promptTemplate": {
                  "templateType": "HTML",
                  "templateText": "$prompt_PREQUAL_SELF_DESCRIBE",
                  "variables": [
                    {
                      "name": "prompt_PREQUAL_SELF_DESCRIBE",
                      "translations": [
                        {
                          "language": "en",
                          "text": ${i18n.en.prequal_question3Prompt}
                        },
                        {
                          "language": "es",
                          "text": ${i18n.es.prequal_question3Prompt}
                        }
                      ]
                    }
                  ]
                },
                "picklistOptions": [
                  {
                    "stableId": "DIAGNOSED",
                    "optionLabelTemplate": {
                      "templateType": "TEXT",
                      "templateText": "$PREQUAL_SELF_DESCRIBE_diagnosed",
                      "variables": [
                        {
                          "name": "PREQUAL_SELF_DESCRIBE_diagnosed",
                          "translations": [
                            {
                              "language": "en",
                              "text": ${i18n.en.prequal_selfDiagnosed}
                            },
                            {
                              "language": "es",
                              "text": ${i18n.es.prequal_selfDiagnosed}
                            }
                          ]
                        }
                      ]
                    },
                    "detailLabelTemplate": null,
                    "allowDetails": false,
                    "exclusive": false
                  },
                  {
                    "stableId": "CHILD_DIAGNOSED",
                    "optionLabelTemplate": {
                      "templateType": "TEXT",
                      "templateText": "$PREQUAL_SELF_DESCRIBE_child_diagnosed",
                      "variables": [
                        {
                          "name": "PREQUAL_SELF_DESCRIBE_child_diagnosed",
                          "translations": [
                            {
                              "language": "en",
                              "text": ${i18n.en.prequal_childDiagnosed}
                            },
                            {
                              "language": "es",
                              "text": ${i18n.es.prequal_childDiagnosed}
                            }
                          ]
                        }
                      ]
                    },
                    "detailLabelTemplate": null,
                    "allowDetails": false,
                    "exclusive": false
                  }
                ],
                "validations": [
                  {
                    "ruleType": "REQUIRED",
                    "hintTemplate": {
                      "templateType": "TEXT",
                      "templateText": "$PREQUAL_SELF_DESCRIBE_req_hint",
                      "variables": [
                        {
                          "name": "PREQUAL_SELF_DESCRIBE_req_hint",
                          "translations": [
                            {
                              "language": "en",
                              "text": ${i18n.en.prequal_choose_option}
                            },
                            {
                              "language": "es",
                              "text": ${i18n.es.prequal_choose_option}
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              "blockType": "QUESTION",
              "shownExpr": null
            },
            {
              "question": ${_includes.diagnosed_primary_cancer_list} {
                "stableId": "DIAGNOSED_PRIMARY_CANCER_LIST"
              },
              "blockType": "QUESTION",
              "shownExpr": """
                              user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")
                              || user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
                           """
            },
            //Metastatic(Advanced) Qs
            {
              "question": ${_includes.diagnosed_primary_cancer_breast_advanced} {
              },
              "blockType": "QUESTION",
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("BREAST")"""
            },
            {
              "question": ${_includes.diagnosed_primary_cancer_prostate_advanced} {
              },
              "blockType": "QUESTION",
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("PROSTATE")"""
            },

            //todo : add below PEX to below Qs once implemented
            // user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].answers.numSelectedOptions()
            // and not in existing studies and if Breast or Prostate hasOption(Yes)
            // and atleast one non-existing study option is selected
            {
              "question": ${_includes.self_age} {
              },
              "blockType": "QUESTION",
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")
                            && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                            """
            },

            {
              "question": {
                include required("../snippets/picklist-question-country-required-eligible-first.conf"),
                "stableId": "SELF_COUNTRY",
                "hideNumber": true,
                "promptTemplate": {
                  "templateType": "TEXT",
                  "templateCode": null,
                  "templateText": "$prompt_COUNTRY",
                  "variables": [
                    {
                      "name": "prompt_COUNTRY",
                      "translations": [
                        {
                          "language": "en",
                          "text": "Where do you currently live?"
                        }
                      ]
                    }
                  ]
                }
              },
              "blockType": "QUESTION",
              "blockGuid": null,
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")
                            && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                            """
            },
            {
              "question": {
                include required("../snippets/picklist-question-state-required.conf"),
                "stableId": "SELF_STATE",
                "hideNumber": true
              },
              "blockType": "QUESTION",
              "blockGuid": null,
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")
                              && user.studies["cmi-pancan"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("US")
                              && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                            """
            },
            {
              "question": {
                include required("../snippets/picklist-question-province-required.conf"),
                "stableId": "SELF_PROVINCE",
                "hideNumber": true
              },
              "blockType": "QUESTION",
              "blockGuid": null,
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")
                              && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                              && user.studies["cmi-pancan"].forms["PREQUAL"].questions["SELF_COUNTRY"].answers.hasOption("CA")
                           """
            },
            {
              "question": ${_includes.child_age} {
              },
              "blockType": "QUESTION",
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
                              && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                           """
            },
            {
              "question": {
                include required("../snippets/picklist-question-country-required-eligible-first.conf"),
                "stableId": "CHILD_COUNTRY",
                "hideNumber": true,
                "promptTemplate": {
                  "templateType": "TEXT",
                  "templateCode": null,
                  "templateText": "$prompt_COUNTRY",
                  "variables": [
                    {
                      "name": "prompt_COUNTRY",
                      "translations": [
                        {
                          "language": "en",
                          "text": "Where does your child currently live?"
                        }
                      ]
                    }
                  ]
                }
              },
              "blockType": "QUESTION",
              "blockGuid": null,
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
                              && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                            """
            },
            {
              "question": {
                include required("../snippets/picklist-question-state-required.conf"),
                "stableId": "CHILD_STATE",
                "hideNumber": true
              },
              "blockType": "QUESTION",
              "blockGuid": null,
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
                              && user.studies["cmi-pancan"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("US")
                              && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                            """
            },
            {
              "question": {
                include required("../snippets/picklist-question-province-required.conf"),
                "stableId": "CHILD_PROVINCE",
                "hideNumber": true
              },
              "blockType": "QUESTION",
              "blockGuid": null,
              "shownExpr": """user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("CHILD_DIAGNOSED")
                              && user.studies["cmi-pancan"].forms["PREQUAL"].questions["CHILD_COUNTRY"].answers.hasOption("CA")
                              && !user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasAnyOption("ANGIOSARCOMA", "BRAIN_TUMOR", "OSTEOSARCOMA", "BREAST", "PROSTATE")
                            """
            }
          ],
          "blockType": "GROUP",
          "shownExpr": null
        }
      ]
    }
  ]
}
