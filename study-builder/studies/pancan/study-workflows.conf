{
  "workflowTransitions": [
    # main study workflow
    {
      "from": {
        "type": "START"
      },
      "to": [
        {
          "type": "ACTIVITY",
          "activityCode": "PREQUAL",
          "expression": "true"
        }
      ]
    },
    {
      "from": {
        "type": "ACTIVITY",
        "activityCode": "PREQUAL"
      },
      "to": [
        {
          "type": "ACTIVITY",
          "activityCode": "PREQUAL",
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("CREATED", "IN_PROGRESS")"""
        },
        {
          "type": "STUDY_REDIRECT",
          "studyGuid": ${mbcStudyGuid},
          "redirectUrl": ${mbcRedirectUrl},
          ## TODO update PEX to add && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].answers.numSelectedOptions() == 1
          ## and user.profile.language() == "en"
          ## and another to entry for user language == "es"
          ## fix issue with && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_BREAST_ADVANCED"].hasOption("YES")
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("BREAST")
          """,
        },
// MBC spanish site redirect
//        {
//          "type": "STUDY_REDIRECT",
//          "studyGuid": ${mbcStudyGuid},
//          "redirectUrl": ${mbcRedirectUrlES},
//          ## TODO update PEX to add && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].answers.numSelectedOptions() == 1
//          ## and user.profile.language() == "en"
//          ## and another to entry for user language == "es"
//          "expression": """
//              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
//               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("BREAST")
//               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_BREAST_ADVANCED"].hasOption("YES")
//               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].answers.numSelectedOptions() == 1
//               && user.profile.language() == "es"
//          """,
//        },
        {
          "type": "STUDY_REDIRECT",
          "studyGuid": ${mpcStudyGuid},
          "redirectUrl": ${mpcRedirectUrl},
          ## TODO update PEX
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("PROSTATE")
          """,
        },
        {
          "type": "STUDY_REDIRECT",
          "studyGuid": ${brainStudyGuid},
          "redirectUrl": ${brainRedirectUrl},
          ## TODO update PEX
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("BRAIN_TUMOR")
          """,
        },
        {
          "type": "STUDY_REDIRECT",
          "studyGuid": ${angioStudyGuid},
          "redirectUrl": ${angioRedirectUrl},
          ## TODO update PEX
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("ANGIOSARCOMA")
          """,
        },
        {
          "type": "STUDY_REDIRECT",
          "studyGuid": ${osteoStudyGuid},
          "redirectUrl": ${osteoRedirectUrl},
          ## TODO update PEX
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
               && user.studies["cmi-pancan"].forms["PREQUAL"].questions["DIAGNOSED_PRIMARY_CANCER_LIST"].children["DIAGNOSED_PRIMARY_CANCER"].answers.hasOption("OSTEOSARCOMA")
          """,
        },
        {
          "type": "ACTIVITY",
          "activityCode": "ABOUTYOU",
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
              && user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("DIAGNOSED")
          """,
        },
        {
          "type": "MAILING_LIST",
          "expression": """
              user.studies["cmi-pancan"].forms["PREQUAL"].isStatus("COMPLETE")
              && user.studies["cmi-pancan"].forms["PREQUAL"].questions["PREQUAL_SELF_DESCRIBE"].answers.hasOption("MAILING_LIST")
          """,
        },
        {
          "type": "DASHBOARD",
          "expression": """user.studies["cmi-pancan"].forms["ABOUTYOU"].isStatus("COMPLETE")"""
        },
      ]
    },
    {
      "from": {
        "type": "RETURN_USER"
      },
      "to": [
        {
          "type": "ACTIVITY",
          "activityCode": "ABOUTYOU",
          "expression": """user.studies["cmi-pancan"].forms["ABOUTYOU"].isStatus("CREATED", "IN_PROGRESS")"""
        },
        {
          "type": "DASHBOARD",
          "expression": """user.studies["cmi-pancan"].forms["ABOUTYOU"].isStatus("COMPLETE")"""
        }
      ]
    }
  ]
}
